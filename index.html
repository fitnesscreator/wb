<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Create Website</title>
  <style>
    /* Basic builder layout */
    body {
      margin: 0;
      padding: 0;
      font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
      background: #faf9ff;
      color: #333;
      text-align: center;
      line-height: 1.6;
    }
    /* Main container with Flexbox */
    .main-container {
      display: flex;
      flex-direction: row;
      justify-content: space-between;
      align-items: flex-start;
      max-width: 1400px;
      margin: 0 auto 40px auto;
      padding: 20px;
      gap: 20px;
    }
    /* Forms section */
    .forms-section {
      flex: 1;
      max-width: 500px;
      padding: 20px;
      height: calc(100vh - 80px);
      overflow-y: auto;
    }
    form {
      margin-bottom: 60px;
      background: transparent;
    }
    .forms-section h2 {
      text-align: left;
      margin-bottom: 15px;
      font-size: 1.5rem;
      color: #555;
      position: relative;
      display: flex;
      align-items: center;
      justify-content: flex-start;
    }
    .forms-section h2::before {
      content: '';
      display: inline-block;
      width: 4px;
      height: 24px;
      background: linear-gradient(to bottom, #5e91ff, #9462ee);
      margin-right: 10px;
    }
    label {
      display: block;
      margin-top: 15px;
      font-weight: 500;
      text-align: left;
      font-size: 0.9rem;
    }
    label img {
      width: 20px;
      height: 20px;
      margin-right: 8px;
      vertical-align: middle;
    }
    input, textarea, select {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      border: 1px solid #ddd;
      border-radius: 6px;
      box-sizing: border-box;
      font-size: 14px;
      transition: border-color 0.2s;
      background: #fff;
      color: #333;
      spellcheck: false;
    }
    input:focus, textarea:focus, select:focus {
      border-color: #2196f3;
      outline: none;
    }
    button {
      color: #fff;
      border: none;
      border-radius: 4px;
      padding: 12px 20px;
      margin-top: 20px;
      font-size: 14px;
      cursor: pointer;
      transition: background 0.3s;
      width: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    button[onclick="addProduct()"],
    button[onclick="addReview()"] {
      background: linear-gradient(to right, #6561e0, #61a3ff);
    }
    button[onclick="addProduct()"]:hover,
    button[onclick="addReview()"]:hover {
      background: linear-gradient(to right, #5450c0, #5090d0);
    }
    button:hover:not([onclick="addProduct()"]):not([onclick="addReview()"]) {
      background: #1976f2;
    }
    /* Disabled Pay Button Styling */
    #payBtn {
      background: #b3d7ff;
      opacity: 0.7;
      cursor: not-allowed;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    #payBtn img {
      margin-right: 8px;
      height: 20px;
      opacity: 0.7;
    }
    /* Enabled state: yellow background with black text/icon */
    #payBtn.enabled {
      background: #ffc439;
      opacity: 1;
      cursor: pointer;
    }
    #payBtn.enabled img {
      opacity: 1;
    }
    /* When payment is successful, icon disappears and text changes */
    /* Buttons for Download and Copy Code */
    #downloadBtn {
      background: linear-gradient(to right, #6561e0, #61a3ff);
    }
    #downloadBtn:hover {
      background: linear-gradient(to right, #5450c0, #5090d0);
    }
    #showCodeBtn {
      background: #17a2b8;
      margin-top: 10px;
    }
    #showCodeBtn:hover {
      background: #138496;
    }
    /* Stylized Add Image Button */
    #addImagesBtn {
      background: transparent;
      border: 1px solid #6561e0;
      color: #6561e0;
      border-radius: 4px;
      padding: 12px 20px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      margin-top: 10px;
    }
    #addImagesBtn .arrow {
      display: inline-block;
      margin-left: 8px;
      transform: rotate(-45deg);
      transition: transform 0.2s;
    }
    #addImagesBtn:hover {
      background: linear-gradient(to right, #6561e0, #61a3ff);
      color: #fff;
      border: none;
    }
    #addImagesBtn:hover .arrow {
      transform: rotate(-45deg) translateX(5px);
    }
    #uploadBtn {
      background: linear-gradient(to right, #fa8b5c, #f6d365);
      border: none;
      color: #fff;
      border-radius: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      cursor: pointer;
      transition: background 0.3s;
    }
    #uploadBtn:hover {
      background: linear-gradient(to right, #f67a45, #f5c64d);
    }
    /* Rotate the Upload Button Arrow */
    #uploadBtn .arrow {
      display: inline-block;
      transition: transform 0.3s ease;
      transform: rotate(-45deg);
    }
    #uploadBtn:hover .arrow {
      transform: rotate(135deg);
    }
    hr {
      margin: 30px 0;
      border: none;
      border-top: 1px solid #eee;
    }
    /* Preview section */
    .preview-section {
      flex: 1.2;
      max-width: 900px;
      background: #fff;
      border: 1px solid #eee;
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .preview-section h2 {
      margin-bottom: 15px;
      font-size: 1.5rem;
      color: #555;
      position: relative;
      display: flex;
      align-items: center;
      justify-content: flex-start;
      width: 100%;
    }
    .preview-section h2::before {
      content: '';
      display: inline-block;
      width: 4px;
      height: 24px;
      background: linear-gradient(to bottom, #5e91ff, #9462ee);
      margin-right: 10px;
    }
    #previewFrame {
      width: 100%;
      min-height: 600px;
      border: 1px solid #ddd;
      border-radius: 4px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
      background: #fff;
    }
    /* Custom Currency Dropdown Styles */
    .currency-dropdown {
      position: relative;
      width: 100%;
    }
    .currency-input {
      width: 100%;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 6px;
      box-sizing: border-box;
      font-size: 14px;
      background: #fff;
      color: #333;
      cursor: pointer;
      spellcheck: false;
    }
    .currency-list {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      max-height: 300px;
      overflow-y: auto;
      border: 1px solid #ddd;
      border-top: none;
      background: #fff;
      z-index: 1000;
      display: none;
    }
    .currency-list.visible {
      display: block;
    }
    .currency-item {
      padding: 10px;
      display: flex;
      align-items: center;
      cursor: pointer;
    }
    .currency-item:hover {
      background: #f0f0f0;
    }
    .currency-flag {
      margin-right: 10px;
      font-size: 1.2rem;
    }
    .currency-code {
      font-weight: bold;
      margin-right: 5px;
    }
    .currency-name {
      color: #555;
    }
    .currency-search {
      padding: 10px;
      border-bottom: 1px solid #ddd;
    }
    .currency-search input {
      width: 100%;
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 14px;
    }
    /* Stylized Add Product Form */
    #addProductForm {
      border: 1px solid #5e91ff;
      border-radius: 8px;
      padding: 20px;
      margin-top: 15px;
    }
    /* Stylized Upload Photos Form */
    #uploadPhotosForm {
      border: 1px solid #5e91ff;
      border-radius: 8px;
      padding: 20px;
      margin-top: 15px;
      background: transparent;
    }
    #uploadPhotosForm h2::before {
      background: #5e91ff;
    }
    #uploadPhotosForm p {
      text-align: left;
      margin-bottom: 20px;
      color: #555;
      font-size: 0.9rem;
    }
    /* Stylized Builder Forms: Hero & Logo, Add Reviews, and About Us */
    #heroLogoForm,
    #addReviewForm,
    #aboutForm {
      border: 1px solid #5e91ff;
      border-radius: 8px;
      padding: 20px;
      margin-top: 15px;
    }
    /* Payment Method Label Enhancements */
    .payment-method-label {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      gap: 4px;
      margin-top: 15px;
    }
    .payment-method-row {
      display: flex;
      align-items: center;
      gap: 4px;
    }
    .payment-method-row img {
      width: 24px;
      height: 24px;
    }
    .payment-method-row span {
      font-weight: 500;
      margin-left: 4px;
    }
    .payment-method-select {
      width: 100%;
    }
    .payment-method-select select {
      width: 100%;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 14px;
      background: #fff;
      color: #333;
      cursor: pointer;
    }
    #howtocreatepaypalbutton {
      padding: 10px 20px;
      background: linear-gradient(to right, #6561e0, #a862ea);
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-weight: bold;
      transition: background 0.3s;
    }
    #howtocreatepaypalbutton:hover {
      background: linear-gradient(to right, #5450c0, #a862ea);
    }
    /* Add Contact Form row */
    .add-contact-form-row {
      margin-top: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .add-contact-form-row img {
      width: 40px;
      height: 40px;
    }
    .add-contact-form-row span {
      font-weight: bold;
      font-size: 1.2rem;
    }
    #addContactFormButton {
      background: linear-gradient(to right, #ff6c6c, #ffc371);
      color: #fff !important;
      font-weight: 600;
    }
    #addContactFormButton:hover {
      background: linear-gradient(to right, #ff4c4c, #ffb347);
    }
    #addContactFormButton.success {
      background: green !important;
      cursor: default;
    }
    /* The contact form modal */
    .modal {
      display: none;
      position: fixed;
      z-index: 9999;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: rgba(0,0,0,0.5);
      justify-content: center;
      align-items: center;
      padding: 20px;
    }
    .modal-content {
      background: #fff;
      margin: auto;
      width: 90%;
      max-width: 800px;
      border-radius: 6px;
      position: relative;
      padding: 20px;
    }
    .modal-close, .modal-close-contact {
      position: absolute;
      top: 15px;
      right: 20px;
      font-size: 1.5rem;
      font-weight: bold;
      cursor: pointer;
      line-height: 1;
    }
    .modal-content h2 {
      margin-top: 0;
    }
    .modal-content textarea {
      margin-top: 15px;
    }
    #confirmAddContactFormButton {
      background: linear-gradient(to right, #ff6c6c, #ffc371);
      color: #fff;
      font-weight: 600;
      margin-top: 20px;
      border: none;
      padding: 12px 20px;
      border-radius: 4px;
      cursor: pointer;
      transition: background 0.3s;
    }
    #confirmAddContactFormButton:hover {
      background: linear-gradient(to right, #ff4c4c, #ffb347);
    }
    /* Contact Us form in the builder */
    #contactUsForm {
      border: 1px solid #5e91ff;
      border-radius: 8px;
      padding: 20px;
      margin-top: 15px;
      background: transparent;
    }
    /* Gradient Line for Section Titles */
    .section-title {
      position: relative;
      display: inline-block;
      padding-left: 25px;
      margin-bottom: 20px;
      font-size: 1.5rem;
      font-weight: 700;
    }
    .section-title::before {
      content: "";
      position: absolute;
      left: 0;
      top: 50%;
      transform: translateY(-50%);
      width: 5px;
      height: 35px;
      background: linear-gradient(to bottom, #6561e0, #a862ea);
      border-radius: 3px;
    }
    /* Email Verification Row Styling */
    #emailVerificationRow {
      display: none;
      margin-top: 10px;
      flex-direction: row;
      align-items: center;
      gap: 10px;
    }
    #emailVerificationRow input {
      width: 80%;
      padding: 8px;
      border: 1px solid #ddd;
      border-radius: 4px;
    }
    #emailVerificationRow button {
      width: 18%;
      padding: 8px;
      background: #28a745;
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    /* Code Modal Styles */
    #codeModal .modal-content {
      max-width: 600px;
      text-align: left;
    }
    #codeModal textarea {
      width: 100%;
      margin-bottom: 10px;
      font-family: monospace;
      font-size: 12px;
    }
    #copyCodeButton {
      background: #2196f3;
      border: none;
      padding: 10px 20px;
      color: #fff;
      border-radius: 4px;
      cursor: pointer;
      transition: background 0.3s;
    }
    #copyCodeButton:hover {
      background: #1976d2;
    }
    /* Responsive adjustments */
    @media (max-width: 1400px) {
      .preview-section {
        flex: 1;
        max-width: 700px;
      }
    }
    @media (max-width: 992px) {
      .main-container {
        flex-direction: column;
      }
      .forms-section, .preview-section {
        max-width: 100%;
      }
    }
    /* --- Custom Builder Added Items Styling --- */
    .builder-item-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 5px 10px;
      border: 1px solid #ddd;
      border-radius: 4px;
      margin-bottom: 5px;
    }
    .builder-item-row span {
      flex: 1;
      text-align: left;
    }
    .delete-btn {
      background-color: red;
      color: #fff;
      border: none;
      width: 30px;
      height: 30px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      border-radius: 4px;
    }
    
    .popup-message {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background-color: #2196F3; /* blue background */
      color: #fff;
      padding: 20px 30px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
      z-index: 10000; /* make sure it's on top */
      max-width: 90%;
      text-align: center;
    }
    
    .popup-message .close {
      position: absolute;
      top: 8px;
      right: 12px;
      font-size: 24px;
      font-weight: bold;
      cursor: pointer;
    }
    
  </style>
</head>
<body>
  <!-- Main container: forms on the left, preview on the right -->
  <div class="main-container">
    <!-- Forms section on the left -->
    <div class="forms-section">
      <!-- Upload Photos Section -->
      <form id="uploadPhotosForm">
        <h2>Upload Photos</h2>
        <p>Upload your Logo, Products Photos... to get their links ğŸ”—</p>
        <button type="button" id="uploadBtn" onclick="redirectToUpload()">Upload <span class="arrow">&#10148;</span></button>
      </form>
      <!-- Hero & Logo Section -->
      <form id="heroLogoForm">
        <h2>Hero & Logo Section</h2>
        <label>Logo Image URL
          <input id="logo" type="text" placeholder="https://example.com/logo.png" required spellcheck="false" maxlength="300">
        </label>
        <label>Hero Banner Image URL
          <input id="banner" type="text" placeholder="https://example.com/hero.jpg" required spellcheck="false" maxlength="300">
        </label>
        <label>Hero Title
          <textarea id="heroText" rows="2" placeholder="Your amazing headline" required spellcheck="false" maxlength="70"></textarea>
        </label>
        <label>CTA Button Text
          <input id="ctaText" type="text" placeholder="Shop Now!" required spellcheck="false" maxlength="30">
        </label>
      </form>
      <!-- Add Products -->
      <form id="addProductForm">
        <h2 class="section-title">Add Products</h2>
        <label>Product Title
          <input id="productTitle" type="text" placeholder="Awesome Gadget" required spellcheck="false" maxlength="60">
        </label>
        <label>1st Image URL
          <input id="image1" type="text" placeholder="https://example.com/product1.jpg" required spellcheck="false" maxlength="300">
        </label>
        <div id="additionalImage2" style="display:none;">
          <label>2nd Image URL
            <input id="image2" type="text" placeholder="https://example.com/product2.jpg" spellcheck="false" maxlength="300">
          </label>
        </div>
        <div id="additionalImage3" style="display:none;">
          <label>3rd Image URL
            <input id="image3" type="text" placeholder="https://example.com/product3.jpg" spellcheck="false" maxlength="300">
          </label>
        </div>
        <button type="button" id="addImagesBtn" onclick="addImageField()">Add Image +</button>
        <label>Currency
          <div class="currency-dropdown">
            <input type="text" id="productCurrency" class="currency-input" placeholder="Select Currency" readonly spellcheck="false">
            <div class="currency-list" id="currencyList">
              <div class="currency-search">
                <input type="text" id="currencySearch" placeholder="Search Currency" spellcheck="false">
              </div>
            </div>
          </div>
        </label>
        <label>Number Sold
          <input id="sold" type="text" placeholder="e.g. 500 (blank or 0 to hide)">
        </label>
        <label>Price
          <input id="price" type="text" placeholder="12.99" required spellcheck="false" maxlength="15">
        </label>
        <label>Shipping Cost (set 0 for FREE)
          <input id="shipping" type="text" placeholder="e.g. 3.99 or 0" required spellcheck="false" maxlength="15">
        </label>
        <label>Returns
          <select id="returns" required>
            <option value="Accepted">Accepted</option>
            <option value="Not Accepted">Not Accepted</option>
          </select>
        </label>
        <label>Color Options (comma-separated)
          <input id="colorOptions" type="text" placeholder="Black, Cream, Green..." required spellcheck="false" maxlength="100">
        </label>
        <label>Size Options (comma-separated)
          <input id="sizeOptions" type="text" placeholder="S, M, L, XL..." required spellcheck="false" maxlength="100">
        </label>
        <label>Description
          <textarea id="description" rows="3" placeholder="Describe the product here" required spellcheck="false" maxlength="300"></textarea>
        </label>
        <!-- Payment Method -->
        <label class="payment-method-label">
          <div class="payment-method-row">
            <img src="https://i.ibb.co/tC9LHLG/Bella-52.png" alt="PayPal">
            <img src="https://i.ibb.co/cCtHLKs/Bella-58.png" alt="Stripe">
            <img src="https://i.ibb.co/m496tmj/Bella-53.png" alt="Checkout Page">
            <span>Select Payment Method</span>
          </div>
          <div class="payment-method-select">
            <select id="productPaymentMethod" required>
              <option value="paypalLink">PayPal Button Link</option>
              <option value="paypalEmbed">PayPal Button Embed Code</option>
              <option value="other">Other Payment Button or Checkout Page</option>
            </select>
          </div>
        </label>
        <div id="productLinkField">
          <label>PayPal Button Link (for this product)
            <textarea id="productLink" rows="2" placeholder="https://www.paypal.com/checkoutnow?token=YOURTOKEN" spellcheck="false" maxlength="1000"></textarea>
          </label>
        </div>
        <div id="productEmbedField" style="display:none;">
          <label>PayPal Button Embed Code (for this product)
            <textarea id="productEmbed" rows="2" placeholder="Embed code..." spellcheck="false" maxlength="2000"></textarea>
          </label>
        </div>
        <div id="otherPaymentField" style="display:none;">
          <label>Other Payment Button or Checkout Page Link
            <input id="otherPaymentLink" type="text" placeholder="https://example.com/checkout" spellcheck="false" maxlength="1000">
          </label>
        </div>
        <button type="button" id="howtocreatepaypalbutton" onclick="window.open('https://www.youtube.com/watch?v=YOUR_VIDEO_ID', '_blank');">
          How to create Paypal button
        </button>
        <button type="button" onclick="addProduct()">Add Product</button>
        <div id="addedProductsList"></div>
      </form>
      <!-- Add Reviews -->
      <form id="addReviewForm">
        <h2>Reviews Section (max 3)</h2>
        <label>Reviewer Name
          <input id="reviewerName" type="text" placeholder="John Doe" required spellcheck="false" maxlength="60">
        </label>
        <label>Stars (1â€“5)
          <select id="reviewStars" required>
            <option value="1">1 star</option>
            <option value="2">2 stars</option>
            <option value="3" selected>3 stars</option>
            <option value="4">4 stars</option>
            <option value="5">5 stars</option>
          </select>
        </label>
        <label>Review Text
          <textarea id="reviewText" rows="2" placeholder="What do you think?" required spellcheck="false" maxlength="300"></textarea>
        </label>
        <button type="button" onclick="addReview()">Add Review</button>
        <div id="addedReviewsList"></div>
      </form>
      <!-- About Us -->
      <form id="aboutForm">
        <h2>About Us Section</h2>
        <label>About Title
          <input id="aboutTitle" type="text" placeholder="Who We Are" required spellcheck="false" maxlength="60">
        </label>
        <label>About Paragraph
          <textarea id="aboutParagraph" rows="3" placeholder="Our story..." required spellcheck="false" maxlength="500"></textarea>
        </label>
        <label>About Image URL
          <input id="aboutImage" type="text" placeholder="https://example.com/about.jpg" required spellcheck="false" maxlength="300">
        </label>
      </form>
      <!-- Contact Us -->
      <form id="contactUsForm">
        <h2 class="section-title">Contact Us</h2>
        <label>Custom Contact Intro
          <textarea id="contactIntro" rows="3" placeholder="Weâ€™d love to hear from you! Reach out..." required spellcheck="false" maxlength="250"></textarea>
        </label>
        <label><img src="https://i.ibb.co/L6zwnKk/Bella-50.png" alt="Instagram">Instagram Link
          <input id="contactInstagram" type="text" placeholder="https://instagram.com/..." required spellcheck="false" maxlength="300">
        </label>
        <label><img src="https://i.ibb.co/2vSmtt0/Bella-49.png" alt="TikTok">TikTok Link
          <input id="contactTiktok" type="text" placeholder="https://tiktok.com/@..." required spellcheck="false" maxlength="300">
        </label>
        <label><img src="https://i.ibb.co/gmDjkH3/Bella-48.png" alt="Facebook">Facebook Link
          <input id="contactFacebook" type="text" placeholder="https://facebook.com/..." required spellcheck="false" maxlength="300">
        </label>
        <label><img src="https://i.ibb.co/fqp0KrB/Bella-63.png" alt="X">X Link
          <input id="contactX" type="text" placeholder="https://x.com/username" required spellcheck="false" maxlength="300">
        </label>
        <label><img src="https://i.ibb.co/hC6CQzs/Bella-62.png" alt="Youtube">Youtube Link
          <input id="contactYoutube" type="text" placeholder="https://youtube.com/@channel" required spellcheck="false" maxlength="300">
        </label>
        <label><img src="https://i.ibb.co/zP00K3P/Bella-51.png" alt="Email">Email Address
          <input id="contactEmail" type="text" placeholder="info@example.com" required spellcheck="false" maxlength="300">
        </label>
        <div class="add-contact-form-row">
          <img src="https://i.ibb.co/jVBBPwZ/Bella-61.png" alt="Jotform">
          <img src="https://i.ibb.co/HNPsXkj/Bella-60.png" alt="Google Forms">
          <span>Add Contact Form</span>
        </div>
        <button type="button" id="addContactFormButton">Add Form</button>
        <div id="contactFormStatus" style="margin-top: 10px;"></div>
      </form>
      <!-- Payment Section: Get Your Website -->
      <section id="paymentSection" class="payment-section">
        <h2 class="section-title">Get your website</h2>
        <p>
          Pay to unlock the download button. If you refresh this page, you will lose the website 
          that you created, so pay and download the website before losing the website you created.
        </p>
        <!-- Pay Button with icon -->
        <button id="payBtn" class="payment-btn" disabled>
          <img id="paypalIcon" src="https://i.ibb.co/PsWwm11F/2ea99dfb-27c1-43a9-84ba-acb7533f7784.png" alt="PayPal Icon">
          <span id="payBtnText">Pay â‚¬12</span>
        </button>
        <!-- Email Verification Row (hidden by default) -->
        <div id="emailVerificationRow">
          <input type="email" id="verificationEmail" placeholder="Enter your email to verify payment">
          <button id="verifyEmailBtn">Verify</button>
        </div>
        <!-- Download & Show Code buttons (hidden initially) -->
        <div class="download-row" id="downloadRow" style="display: none;">
          <button id="downloadBtn" onclick="downloadSite()" class="unlock-button">Download Website File</button>
          <button id="showCodeBtn" onclick="openCodeModal()" class="unlock-button">Copy Website Code</button>
        </div>
      </section>
    </div>
    <!-- Preview section on the right -->
    <div class="preview-section">
      <h2>Live Preview</h2>
      <iframe id="previewFrame"></iframe>
    </div>
  </div>
  
  <!-- Contact Form Modal -->
  <div id="contactFormModal" class="modal">
    <div class="modal-content">
      <span class="modal-close-contact" id="closeContactFormModal">&times;</span>
      <h2>Create Your Contact Form</h2>
      <p style="font-weight:bold">
        Step 1: Create your contact form in one of these companies (Jotform, Google Forms...)
      </p>
      <p style="font-weight:bold">
        Step 2: Paste the embed HTML code of your form here:
      </p>
      <textarea id="contactFormIframe" rows="5" placeholder="Paste your contact form iframe HTML code here..."></textarea>
      <button type="button" id="confirmAddContactFormButton">Add</button>
    </div>
  </div>
  
  <!-- Code Modal for Copying Website Code -->
  <div id="codeModal" class="modal">
    <div class="modal-content">
      <span class="modal-close" id="closeCodeModal">&times;</span>
      <h2>Website Code</h2>
      <textarea id="codeOutput" rows="10" readonly></textarea>
      <button id="copyCodeButton">Copy Code</button>
    </div>
  </div>
  
  <!-- Custom Exit Confirmation Modal -->
  <div id="exitConfirm-modalOverlay" class="modal-overlay">
    <div id="exitConfirm-modal" class="modal">
      <p>To download your website, please complete your purchase. If you refresh this page, your progress will be lost. Make sure to download your website now to keep your work safe.</p>
      <div class="modal-buttons">
        <button id="exitConfirm-stayButton" class="btn-ok">Oky</button>
        <button id="exitConfirm-leaveButton" class="btn-cancel">I'm sure I want to leave</button>
      </div>
    </div>
  </div>
  
  <!-- Popup Message -->
  <div id="popupMessage" class="popup-message">
    <span class="close">&times;</span>
    <p>
      Hi ğŸ˜Š, This website does not save your progress, so make sure not to refresh or leave this website before downloading the website you created. Thank you!
    </p>
  </div>
  
  <script>
    // ============== CURRENCY DATA ==============
    const currencyData = [
      { code: "AED", name: "United Arab Emirates Dirham", symbol: "Ø¯.Ø¥", flag: "ğŸ‡¦ğŸ‡ª" },
      { code: "AFN", name: "Afghan Afghani", symbol: "Ø‹", flag: "ğŸ‡¦ğŸ‡«" },
      { code: "ALL", name: "Albanian Lek", symbol: "L", flag: "ğŸ‡¦ğŸ‡±" },
      { code: "AMD", name: "Armenian Dram", symbol: "Ö", flag: "ğŸ‡¦ğŸ‡²" },
      { code: "ANG", name: "Netherlands Antillean Guilder", symbol: "Æ’", flag: "ğŸ‡³ğŸ‡±" },
      { code: "AOA", name: "Angolan Kwanza", symbol: "Kz", flag: "ğŸ‡¦ğŸ‡´" },
      { code: "ARS", name: "Argentine Peso", symbol: "$", flag: "ğŸ‡¦ğŸ‡·" },
      { code: "AUD", name: "Australian Dollar", symbol: "A$", flag: "ğŸ‡¦ğŸ‡º" },
      { code: "AWG", name: "Aruban Florin", symbol: "Æ’", flag: "ğŸ‡¦ğŸ‡¼" },
      { code: "AZN", name: "Azerbaijani Manat", symbol: "â‚¼", flag: "ğŸ‡¦ğŸ‡¿" },
      { code: "BAM", name: "Bosnia-Herzegovina Convertible Mark", symbol: "KM", flag: "ğŸ‡§ğŸ‡¦" },
      { code: "BBD", name: "Barbadian Dollar", symbol: "Bds$", flag: "ğŸ‡§ğŸ‡§" },
      { code: "BDT", name: "Bangladeshi Taka", symbol: "à§³", flag: "ğŸ‡§ğŸ‡©" },
      { code: "BGN", name: "Bulgarian Lev", symbol: "Ğ»Ğ²", flag: "ğŸ‡§ğŸ‡¬" },
      { code: "BHD", name: "Bahraini Dinar", symbol: "Ø¯.Ø¨", flag: "ğŸ‡§ğŸ‡­" },
      { code: "BIF", name: "Burundian Franc", symbol: "FBu", flag: "ğŸ‡§ğŸ‡®" },
      { code: "BMD", name: "Bermudan Dollar", symbol: "$", flag: "ğŸ‡§ğŸ‡²" },
      { code: "BND", name: "Brunei Dollar", symbol: "B$", flag: "ğŸ‡§ğŸ‡³" },
      { code: "BOB", name: "Bolivian Boliviano", symbol: "$b", flag: "ğŸ‡§ğŸ‡´" },
      { code: "BRL", name: "Brazilian Real", symbol: "R$", flag: "ğŸ‡§ğŸ‡·" },
      { code: "BSD", name: "Bahamian Dollar", symbol: "$", flag: "ğŸ‡§ğŸ‡¸" },
      { code: "BTN", name: "Bhutanese Ngultrum", symbol: "Nu.", flag: "ğŸ‡§ğŸ‡¹" },
      { code: "BWP", name: "Botswanan Pula", symbol: "P", flag: "ğŸ‡§ğŸ‡¼" },
      { code: "BYN", name: "Belarusian Ruble", symbol: "Br", flag: "ğŸ‡§ğŸ‡¾" },
      { code: "BZD", name: "Belize Dollar", symbol: "BZ$", flag: "ğŸ‡§ğŸ‡¿" },
      { code: "CAD", name: "Canadian Dollar", symbol: "C$", flag: "ğŸ‡¨ğŸ‡¦" },
      { code: "CDF", name: "Congolese Franc", symbol: "FC", flag: "ğŸ‡¨ğŸ‡©" },
      { code: "CHF", name: "Swiss Franc", symbol: "CHF", flag: "ğŸ‡¨ğŸ‡­" },
      { code: "CLP", name: "Chilean Peso", symbol: "$", flag: "ğŸ‡¨ğŸ‡±" },
      { code: "CNY", name: "Chinese Yuan", symbol: "Â¥", flag: "ğŸ‡¨ğŸ‡³" },
      { code: "COP", name: "Colombian Peso", symbol: "$", flag: "ğŸ‡¨ğŸ‡´" },
      { code: "CRC", name: "Costa Rican ColÃ³n", symbol: "â‚¡", flag: "ğŸ‡¨ğŸ‡·" },
      { code: "CUC", name: "Cuban Convertible Peso", symbol: "$", flag: "ğŸ‡¨ğŸ‡º" },
      { code: "CUP", name: "Cuban Peso", symbol: "$", flag: "ğŸ‡¨ğŸ‡º" },
      { code: "CVE", name: "Cape Verdean Escudo", symbol: "$", flag: "ğŸ‡¨ğŸ‡»" },
      { code: "CZK", name: "Czech Koruna", symbol: "KÄ", flag: "ğŸ‡¨ğŸ‡¿" },
      { code: "DJF", name: "Djiboutian Franc", symbol: "Fdj", flag: "ğŸ‡©ğŸ‡¯" },
      { code: "DKK", name: "Danish Krone", symbol: "kr", flag: "ğŸ‡©ğŸ‡°" },
      { code: "DOP", name: "Dominican Peso", symbol: "RD$", flag: "ğŸ‡©ğŸ‡´" },
      { code: "DZD", name: "Algerian Dinar", symbol: "Ø¯.Ø¬", flag: "ğŸ‡©ğŸ‡¿" },
      { code: "EGP", name: "Egyptian Pound", symbol: "Â£", flag: "ğŸ‡ªğŸ‡¬" },
      { code: "ERN", name: "Eritrean Nakfa", symbol: "Nfk", flag: "ğŸ‡ªğŸ‡·" },
      { code: "ETB", name: "Ethiopian Birr", symbol: "Br", flag: "ğŸ‡ªğŸ‡¹" },
      { code: "EUR", name: "Euro", symbol: "â‚¬", flag: "ğŸ‡ªğŸ‡º" },
      { code: "FJD", name: "Fijian Dollar", symbol: "FJ$", flag: "ğŸ‡«ğŸ‡¯" },
      { code: "FKP", name: "Falkland Islands Pound", symbol: "Â£", flag: "ğŸ‡«ğŸ‡°" },
      { code: "FOK", name: "Faroese KrÃ³na", symbol: "kr", flag: "ğŸ‡«ğŸ‡´" },
      { code: "GBP", name: "British Pound Sterling", symbol: "Â£", flag: "ğŸ‡¬ğŸ‡§" },
      { code: "GEL", name: "Georgian Lari", symbol: "â‚¾", flag: "ğŸ‡¬ğŸ‡ª" },
      { code: "GGP", name: "Guernsey Pound", symbol: "Â£", flag: "ğŸ‡¬ğŸ‡¬" },
      { code: "GHS", name: "Ghanaian Cedi", symbol: "â‚µ", flag: "ğŸ‡¬ğŸ‡­" },
      { code: "GIP", name: "Gibraltar Pound", symbol: "Â£", flag: "ğŸ‡¬ğŸ‡®" },
      { code: "GMD", name: "Gambian Dalasi", symbol: "D", flag: "ğŸ‡¬ğŸ‡²" },
      { code: "GNF", name: "Guinean Franc", symbol: "FG", flag: "ğŸ‡¬ğŸ‡³" },
      { code: "GTQ", name: "Guatemalan Quetzal", symbol: "Q", flag: "ğŸ‡¬ğŸ‡¹" },
      { code: "GYD", name: "Guyanese Dollar", symbol: "G$", flag: "ğŸ‡¬ğŸ‡¾" },
      { code: "HKD", name: "Hong Kong Dollar", symbol: "HK$", flag: "ğŸ‡­ğŸ‡°" },
      { code: "HNL", name: "Honduran Lempira", symbol: "L", flag: "ğŸ‡­ğŸ‡³" },
      { code: "HRK", name: "Croatian Kuna", symbol: "kn", flag: "ğŸ‡­ğŸ‡·" },
      { code: "HTG", name: "Haitian Gourde", symbol: "G", flag: "ğŸ‡­ğŸ‡¹" },
      { code: "HUF", name: "Hungarian Forint", symbol: "Ft", flag: "ğŸ‡­ğŸ‡º" },
      { code: "IDR", name: "Indonesian Rupiah", symbol: "Rp", flag: "ğŸ‡®ğŸ‡©" },
      { code: "ILS", name: "Israeli New Shekel", symbol: "â‚ª", flag: "ğŸ‡®ğŸ‡±" },
      { code: "IMP", name: "Isle of Man Pound", symbol: "Â£", flag: "ğŸ‡®ğŸ‡²" },
      { code: "INR", name: "Indian Rupee", symbol: "â‚¹", flag: "ğŸ‡®ğŸ‡³" },
      { code: "IQD", name: "Iraqi Dinar", symbol: "Ø¹.Ø¯", flag: "ğŸ‡®ğŸ‡¶" },
      { code: "IRR", name: "Iranian Rial", symbol: "ï·¼", flag: "ğŸ‡®ğŸ‡·" },
      { code: "ISK", name: "Icelandic KrÃ³na", symbol: "kr", flag: "ğŸ‡®ğŸ‡¸" },
      { code: "JEP", name: "Jersey Pound", symbol: "Â£", flag: "ğŸ‡¯ğŸ‡ª" },
      { code: "JMD", name: "Jamaican Dollar", symbol: "J$", flag: "ğŸ‡¯ğŸ‡²" },
      { code: "JOD", name: "Jordanian Dinar", symbol: "Ø¯.Ø§", flag: "ğŸ‡¯ğŸ‡´" },
      { code: "JPY", name: "Japanese Yen", symbol: "Â¥", flag: "ğŸ‡¯ğŸ‡µ" },
      { code: "KES", name: "Kenyan Shilling", symbol: "KSh", flag: "ğŸ‡°ğŸ‡ª" },
      { code: "KGS", name: "Kyrgyzstani Som", symbol: "ÑĞ¾Ğ¼", flag: "ğŸ‡°ğŸ‡¬" },
      { code: "KHR", name: "Cambodian Riel", symbol: "áŸ›", flag: "ğŸ‡°ğŸ‡­" },
      { code: "KMF", name: "Comorian Franc", symbol: "CF", flag: "ğŸ‡°ğŸ‡²" },
      { code: "KPW", name: "North Korean Won", symbol: "â‚©", flag: "ğŸ‡°ğŸ‡µ" },
      { code: "KRW", name: "South Korean Won", symbol: "â‚©", flag: "ğŸ‡°ğŸ‡·" },
      { code: "KWD", name: "Kuwaiti Dinar", symbol: "Ø¯.Ùƒ", flag: "ğŸ‡°ğŸ‡¼" },
      { code: "KYD", name: "Cayman Islands Dollar", symbol: "KYD", flag: "ğŸ‡°ğŸ‡¾" },
      { code: "KZT", name: "Kazakhstani Tenge", symbol: "â‚¸", flag: "ğŸ‡°ğŸ‡¿" },
      { code: "LAK", name: "Laotian Kip", symbol: "â‚­", flag: "ğŸ‡±ğŸ‡¦" },
      { code: "LBP", name: "Lebanese Pound", symbol: "Â£", flag: "ğŸ‡±ğŸ‡§" },
      { code: "LKR", name: "Sri Lankan Rupee", symbol: "Rs", flag: "ğŸ‡±ğŸ‡°" },
      { code: "LRD", name: "Liberian Dollar", symbol: "L$", flag: "ğŸ‡±ğŸ‡·" },
      { code: "LSL", name: "Lesotho Loti", symbol: "L", flag: "ğŸ‡±ğŸ‡¸" },
      { code: "LYD", name: "Libyan Dinar", symbol: "Ù„.Ø¯", flag: "ğŸ‡±ğŸ‡¾" },
      { code: "MAD", name: "Moroccan Dirham", symbol: "Ø¯.Ù….", flag: "ğŸ‡²ğŸ‡¦" },
      { code: "MDL", name: "Moldovan Leu", symbol: "L", flag: "ğŸ‡²ğŸ‡©" },
      { code: "MGA", name: "Malagasy Ariary", symbol: "Ar", flag: "ğŸ‡²ğŸ‡¬" },
      { code: "MKD", name: "Macedonian Denar", symbol: "Ğ´ĞµĞ½", flag: "ğŸ‡²ğŸ‡°" },
      { code: "MMK", name: "Myanmar Kyat", symbol: "K", flag: "ğŸ‡²ğŸ‡²" },
      { code: "MNT", name: "Mongolian Tugrik", symbol: "â‚®", flag: "ğŸ‡²ğŸ‡³" },
      { code: "MOP", name: "Macanese Pataca", symbol: "MOP$", flag: "ğŸ‡²ğŸ‡´" },
      { code: "MRU", name: "Mauritanian Ouguiya", symbol: "UM", flag: "ğŸ‡²ğŸ‡·" },
      { code: "MUR", name: "Mauritian Rupee", symbol: "â‚¨", flag: "ğŸ‡²ğŸ‡º" },
      { code: "MVR", name: "Maldivian Rufiyaa", symbol: "Rf", flag: "ğŸ‡²ğŸ‡»" },
      { code: "MWK", name: "Malawian Kwacha", symbol: "MK", flag: "ğŸ‡²ğŸ‡¼" },
      { code: "MXN", name: "Mexican Peso", symbol: "$", flag: "ğŸ‡²ğŸ‡½" },
      { code: "MYR", name: "Malaysian Ringgit", symbol: "RM", flag: "ğŸ‡²ğŸ‡¾" },
      { code: "MZN", name: "Mozambican Metical", symbol: "MT", flag: "ğŸ‡²ğŸ‡¿" },
      { code: "NAD", name: "Namibian Dollar", symbol: "N$", flag: "ğŸ‡³ğŸ‡¦" },
      { code: "NGN", name: "Nigerian Naira", symbol: "â‚¦", flag: "ğŸ‡³ğŸ‡¬" },
      { code: "NIO", name: "Nicaraguan CÃ³rdoba", symbol: "C$", flag: "ğŸ‡³ğŸ‡®" },
      { code: "NOK", name: "Norwegian Krone", symbol: "kr", flag: "ğŸ‡³ğŸ‡´" },
      { code: "NPR", name: "Nepalese Rupee", symbol: "â‚¨", flag: "ğŸ‡³ğŸ‡µ" },
      { code: "NZD", name: "New Zealand Dollar", symbol: "NZ$", flag: "ğŸ‡³ğŸ‡¿" },
      { code: "OMR", name: "Omani Rial", symbol: "Ø±.Ø¹.", flag: "ğŸ‡´ğŸ‡²" },
      { code: "PAB", name: "Panamanian Balboa", symbol: "B/.", flag: "ğŸ‡µğŸ‡¦" },
      { code: "PEN", name: "Peruvian Nuevo Sol", symbol: "S/.", flag: "ğŸ‡µğŸ‡ª" },
      { code: "PGK", name: "Papua New Guinean Kina", symbol: "K", flag: "ğŸ‡µğŸ‡¬" },
      { code: "PHP", name: "Philippine Peso", symbol: "â‚±", flag: "ğŸ‡µğŸ‡­" },
      { code: "PKR", name: "Pakistani Rupee", symbol: "â‚¨", flag: "ğŸ‡µğŸ‡°" },
      { code: "PLN", name: "Polish ZÅ‚oty", symbol: "zÅ‚", flag: "ğŸ‡µğŸ‡±" },
      { code: "PYG", name: "Paraguayan GuaranÃ­", symbol: "â‚²", flag: "ğŸ‡µğŸ‡¾" },
      { code: "QAR", name: "Qatari Rial", symbol: "Ø±.Ù‚", flag: "ğŸ‡¶ğŸ‡¦" },
      { code: "RON", name: "Romanian Leu", symbol: "lei", flag: "ğŸ‡·ğŸ‡´" },
      { code: "RSD", name: "Serbian Dinar", symbol: "din", flag: "ğŸ‡·ğŸ‡¸" },
      { code: "RUB", name: "Russian Ruble", symbol: "â‚½", flag: "ğŸ‡·ğŸ‡º" },
      { code: "RWF", name: "Rwandan Franc", symbol: "FRw", flag: "ğŸ‡·ğŸ‡¼" },
      { code: "SAR", name: "Saudi Riyal", symbol: "Ø±.Ø³", flag: "ğŸ‡¸ğŸ‡¦" },
      { code: "SBD", name: "Solomon Islands Dollar", symbol: "SI$", flag: "ğŸ‡¸ğŸ‡§" },
      { code: "SCR", name: "Seychellois Rupee", symbol: "â‚¨", flag: "ğŸ‡¸ğŸ‡¨" },
      { code: "SDG", name: "Sudanese Pound", symbol: "Â£", flag: "ğŸ‡¸ğŸ‡©" },
      { code: "SEK", name: "Swedish Krona", symbol: "kr", flag: "ğŸ‡¸ğŸ‡ª" },
      { code: "SGD", name: "Singapore Dollar", symbol: "S$", flag: "ğŸ‡¸ğŸ‡¬" },
      { code: "SHP", name: "Saint Helena Pound", symbol: "Â£", flag: "ğŸ‡¸ğŸ‡­" },
      { code: "SLL", name: "Sierra Leonean Leone", symbol: "Le", flag: "ğŸ‡¸ğŸ‡±" },
      { code: "SOS", name: "Somali Shilling", symbol: "S", flag: "ğŸ‡¸ğŸ‡´" },
      { code: "SRD", name: "Surinamese Dollar", symbol: "$", flag: "ğŸ‡¸ğŸ‡·" },
      { code: "SSP", name: "South Sudanese Pound", symbol: "Â£", flag: "ğŸ‡¸ğŸ‡¸" },
      { code: "STD", name: "SÃ£o TomÃ© and PrÃ­ncipe Dobra", symbol: "Db", flag: "ğŸ‡¸ğŸ‡¹" },
      { code: "STN", name: "SÃ£o TomÃ© and PrÃ­ncipe Dobra", symbol: "Db", flag: "ğŸ‡¸ğŸ‡¹" },
      { code: "SVC", name: "Salvadoran ColÃ³n", symbol: "$", flag: "ğŸ‡¸ğŸ‡»" },
      { code: "SYP", name: "Syrian Pound", symbol: "Â£", flag: "ğŸ‡¸ğŸ‡¾" },
      { code: "SZL", name: "Swazi Lilangeni", symbol: "E", flag: "ğŸ‡¸ğŸ‡¿" },
      { code: "THB", name: "Thai Baht", symbol: "à¸¿", flag: "ğŸ‡¹ğŸ‡­" },
      { code: "TJS", name: "Tajikistani Somoni", symbol: "Ğ…Ğœ", flag: "ğŸ‡¹ğŸ‡¯" },
      { code: "TMT", name: "Turkmenistani Manat", symbol: "m", flag: "ğŸ‡¹ğŸ‡²" },
      { code: "TND", name: "Tunisian Dinar", symbol: "Ø¯.Øª", flag: "ğŸ‡¹ğŸ‡³" },
      { code: "TOP", name: "Tongan PaÊ»anga", symbol: "T$", flag: "ğŸ‡¹ğŸ‡´" },
      { code: "TRY", name: "Turkish Lira", symbol: "â‚º", flag: "ğŸ‡¹ğŸ‡·" },
      { code: "TTD", name: "Trinidad and Tobago Dollar", symbol: "TT$", flag: "ğŸ‡¹ğŸ‡¹" },
      { code: "TWD", name: "New Taiwan Dollar", symbol: "NT$", flag: "ğŸ‡¹ğŸ‡¼" },
      { code: "TZS", name: "Tanzanian Shilling", symbol: "TSh", flag: "ğŸ‡¹ğŸ‡¿" },
      { code: "UAH", name: "Ukrainian Hryvnia", symbol: "â‚´", flag: "ğŸ‡ºğŸ‡¦" },
      { code: "UGX", name: "Ugandan Shilling", symbol: "USh", flag: "ğŸ‡ºğŸ‡¬" },
      { code: "USD", name: "United States Dollar", symbol: "$", flag: "ğŸ‡ºğŸ‡¸" },
      { code: "UYU", name: "Uruguayan Peso", symbol: "$U", flag: "ğŸ‡ºğŸ‡¾" },
      { code: "UZS", name: "Uzbekistan Som", symbol: "UZS", flag: "ğŸ‡ºğŸ‡¿" },
      { code: "VES", name: "Venezuelan BolÃ­var Soberano", symbol: "Bs.S", flag: "ğŸ‡»ğŸ‡ª" },
      { code: "VND", name: "Vietnamese Dong", symbol: "â‚«", flag: "ğŸ‡»ğŸ‡³" },
      { code: "VUV", name: "Vanuatu Vatu", symbol: "VT", flag: "ğŸ‡»ğŸ‡º" },
      { code: "WST", name: "Samoan Tala", symbol: "WS$", flag: "ğŸ‡¼ğŸ‡¸" },
      { code: "XAF", name: "CFA Franc BEAC", symbol: "FCFA", flag: "ğŸ‡¨ğŸ‡«" },
      { code: "XCD", name: "East Caribbean Dollar", symbol: "EC$", flag: "ğŸ‡¨ğŸ‡©" },
      { code: "XDR", name: "Special Drawing Rights", symbol: "XDR", flag: "ğŸ‡ºğŸ‡³" },
      { code: "XOF", name: "CFA Franc BCEAO", symbol: "CFA", flag: "ğŸ‡¨ğŸ‡®" },
      { code: "XPF", name: "CFP Franc", symbol: "CFPF", flag: "ğŸ‡µğŸ‡«" },
      { code: "YER", name: "Yemeni Rial", symbol: "ï·¼", flag: "ğŸ‡¾ğŸ‡ª" },
      { code: "ZAR", name: "South African Rand", symbol: "R", flag: "ğŸ‡¿ğŸ‡¦" },
      { code: "ZMW", name: "Zambian Kwacha", symbol: "ZK", flag: "ğŸ‡¿ğŸ‡²" },
      { code: "ZWL", name: "Zimbabwean Dollar", symbol: "Z$", flag: "ğŸ‡¿ğŸ‡¼" }
    ];
    // ============== DATA STRUCTURES ==============
    var heroData    = { logo:'', banner:'', heroText:'', ctaText:'' };
    var products    = [];
    var reviews     = [];
    var aboutData   = { title:'', paragraph:'', image:'' };
    var contactData = { 
      intro:'', 
      instagram:'', 
      tiktok:'', 
      facebook:'', 
      xLink:'', 
      youtube:'', 
      email:'', 
      formEmbed:'',
      googleAnalytics: ''
    };
    var finalHTML   = '';
    // ============== Mandatory Fields Check ==============
    function checkMandatory() {
      // Global mandatory fields plus at least one added product and review:
      if (document.getElementById('logo').value.trim() === "") return false;
      if (document.getElementById('banner').value.trim() === "") return false;
      if (document.getElementById('heroText').value.trim() === "") return false;
      if (document.getElementById('ctaText').value.trim() === "") return false;
      if (products.length < 1) return false;
      if (reviews.length < 1) return false;
      if (document.getElementById('aboutTitle').value.trim() === "") return false;
      if (document.getElementById('aboutParagraph').value.trim() === "") return false;
      if (document.getElementById('aboutImage').value.trim() === "") return false;
      if (document.getElementById('contactEmail').value.trim() === "") return false;
      return true;
    }
    // ============== ON LOAD ==============
    window.onload = function(){
      document.getElementById('logo').oninput     = updatePreview;
      document.getElementById('banner').oninput   = updatePreview;
      document.getElementById('heroText').oninput = updatePreview;
      document.getElementById('ctaText').oninput  = updatePreview;
      document.getElementById('aboutTitle').oninput     = updatePreview;
      document.getElementById('aboutParagraph').oninput = updatePreview;
      document.getElementById('aboutImage').oninput     = updatePreview;
      document.getElementById('contactIntro').oninput     = updatePreview;
      document.getElementById('contactInstagram').oninput = updatePreview;
      document.getElementById('contactTiktok').oninput    = updatePreview;
      document.getElementById('contactFacebook').oninput  = updatePreview;
      document.getElementById('contactX').oninput         = updatePreview;
      document.getElementById('contactYoutube').oninput   = updatePreview;
      document.getElementById('contactEmail').oninput     = updatePreview;
      document.getElementById('productPaymentMethod').onchange = function(){
        var method = this.value;
        document.getElementById('productLinkField').style.display = (method === 'paypalLink') ? 'block' : 'none';
        document.getElementById('productEmbedField').style.display = (method === 'paypalEmbed') ? 'block' : 'none';
        document.getElementById('otherPaymentField').style.display = (method === 'other') ? 'block' : 'none';
        updatePreview();
      };
      document.getElementById('productLink').oninput   = updatePreview;
      document.getElementById('productEmbed').oninput  = updatePreview;
      document.getElementById('otherPaymentLink').oninput = updatePreview;
      updateAddProductFormFields();
      setupContactFormModal();
      updateManagementLists();
    };
    // ============== CURRENCY DROPDOWN INIT ==============
    document.addEventListener('DOMContentLoaded', function() {
      const currencyInput = document.getElementById('productCurrency');
      const currencyList  = document.getElementById('currencyList');
      const currencySearch= document.getElementById('currencySearch');
      currencyData.forEach(currency => {
        const item = document.createElement('div');
        item.classList.add('currency-item');
        item.innerHTML = `<span class="currency-flag">${currency.flag}</span>
                          <span class="currency-code">${currency.code}</span>
                          <span class="currency-name">${currency.name}</span>`;
        item.addEventListener('click', () => {
          currencyInput.value = `${currency.code} - ${currency.name}`;
          currencyInput.setAttribute('data-code', currency.code);
          currencyList.classList.remove('visible');
          updatePreview();
        });
        currencyList.appendChild(item);
      });
      const defaultCurrency = currencyData.find(c => c.code === "EUR");
      if (defaultCurrency) {
        currencyInput.value = `${defaultCurrency.code} - ${defaultCurrency.name}`;
        currencyInput.setAttribute('data-code', defaultCurrency.code);
      }
      currencyInput.addEventListener('click', () => {
        currencyList.classList.toggle('visible');
        currencySearch.focus();
      });
      document.addEventListener('click', function(e) {
        if (!currencyInput.contains(e.target) && !currencyList.contains(e.target)) {
          currencyList.classList.remove('visible');
        }
      });
      currencySearch.addEventListener('input', function() {
        const filter = currencySearch.value.toUpperCase();
        const items = currencyList.getElementsByClassName('currency-item');
        for (let i = 0; i < items.length; i++) {
          const txtValue = items[i].textContent || items[i].innerText;
          if (txtValue.toUpperCase().indexOf(filter) > -1) {
            items[i].style.display = "";
          } else {
            items[i].style.display = "none";
          }
        }
      });
    });
    // ============== FUNCTIONS ==============
    function updateAddProductFormFields(){
      var method = document.getElementById('productPaymentMethod').value;
      document.getElementById('productLinkField').style.display   = (method === 'paypalLink') ? 'block' : 'none';
      document.getElementById('productEmbedField').style.display  = (method === 'paypalEmbed') ? 'block' : 'none';
      document.getElementById('otherPaymentField').style.display  = (method === 'other') ? 'block' : 'none';
    }
    var imageCount = 1;
    function addImageField(){
      imageCount++;
      if(imageCount === 2){
        document.getElementById('additionalImage2').style.display = 'block';
      } else if(imageCount === 3){
        document.getElementById('additionalImage3').style.display = 'block';
        document.getElementById('addImagesBtn').style.display = 'none';
      }
    }
    function addProduct(){
      var title        = document.getElementById('productTitle').value.trim();
      var img1         = document.getElementById('image1').value.trim();
      var img2         = document.getElementById('image2').value.trim();
      var img3         = document.getElementById('image3').value.trim();
      var currencyInput= document.getElementById('productCurrency');
      var currencyCode = currencyInput.getAttribute('data-code') || 'EUR';
      var sold         = document.getElementById('sold').value.trim();
      var price        = document.getElementById('price').value.trim();
      var shipping     = document.getElementById('shipping').value.trim();
      var returns      = document.getElementById('returns').value;
      var coloroptions = document.getElementById('colorOptions').value.trim();
      var sizeoptions  = document.getElementById('sizeOptions').value.trim();
      var desc         = document.getElementById('description').value.trim();
      var paymentMethod= document.getElementById('productPaymentMethod').value;
      var productLink       = "";
      var productEmbed      = "";
      var otherPaymentLink  = "";
      if(paymentMethod === 'paypalLink'){
        productLink  = document.getElementById('productLink').value.trim();
      }
      if(paymentMethod === 'paypalEmbed'){
        productEmbed = document.getElementById('productEmbed').value.trim();
      }
      if(paymentMethod === 'other'){
        otherPaymentLink = document.getElementById('otherPaymentLink').value.trim();
      }
      // Validate product form fields before adding:
      if(!title || !img1 || !price || !coloroptions || !desc){
        alert("Please fill out all mandatory fields for the product before adding.");
        return;
      }
      var imgs = [img1];
      if(img2) imgs.push(img2);
      if(img3) imgs.push(img3);
      var shippingVal = "FREE";
      if(shipping && shipping!=="0"){
        shippingVal = shipping;
      }
      var soldVal = "";
      if(sold && sold!=="0"){
        soldVal = sold;
      }
      var product = {
        title: title,
        images: imgs,
        sold: soldVal,
        price: price,
        currency: currencyCode,
        shipping: shippingVal,
        returns: returns,
        coloroptions: coloroptions,
        sizeoptions: sizeoptions,
        description: desc,
        paymentMethod: paymentMethod,
        paypalLink: productLink,
        paypalEmbed: productEmbed,
        otherPaymentLink: otherPaymentLink
      };
      products.push(product);
      // Clear product form fields:
      document.getElementById('productTitle').value='';
      document.getElementById('image1').value='';
      document.getElementById('image2').value='';
      document.getElementById('image3').value='';
      currencyInput.value='';
      currencyInput.removeAttribute('data-code');
      document.getElementById('sold').value='';
      document.getElementById('price').value='';
      document.getElementById('shipping').value='';
      document.getElementById('description').value='';
      document.getElementById('colorOptions').value='';
      document.getElementById('sizeOptions').value='';
      document.getElementById('productPaymentMethod').value='paypalLink';
      document.getElementById('productLink').value='';
      document.getElementById('productEmbed').value='';
      document.getElementById('otherPaymentLink').value='';
      updateAddProductFormFields();
      imageCount=1;
      document.getElementById('additionalImage2').style.display='none';
      document.getElementById('additionalImage3').style.display='none';
      document.getElementById('addImagesBtn').style.display='block';
      const defaultCurrency = currencyData.find(c => c.code === "EUR");
      if(defaultCurrency){
        currencyInput.value = `${defaultCurrency.code} - ${defaultCurrency.name}`;
        currencyInput.setAttribute('data-code', defaultCurrency.code);
      }
      updatePreview();
      renderAddedProductsList();
    }
    function renderAddedProductsList() {
      const container = document.getElementById('addedProductsList');
      container.innerHTML = '';
      products.forEach((prod, idx) => {
        const row = document.createElement('div');
        row.classList.add('builder-item-row');
        const textSpan = document.createElement('span');
        textSpan.textContent = prod.title || 'Untitled';
        row.appendChild(textSpan);
        const delBtn = document.createElement('button');
        delBtn.classList.add('delete-btn');
        delBtn.textContent = 'Ã—';
        delBtn.onclick = function() {
          products.splice(idx, 1);
          renderAddedProductsList();
          updatePreview();
        };
        row.appendChild(delBtn);
        container.appendChild(row);
      });
    }
    function addReview(){
      if(reviews.length >= 3){
        alert("You can only add up to 3 reviews!");
        return;
      }
      var name = document.getElementById('reviewerName').value.trim();
      var s    = document.getElementById('reviewStars').value;
      var txt  = document.getElementById('reviewText').value.trim();
      if(!name || !txt){
        alert("Please fill out reviewer's name and text!");
        return;
      }
      reviews.push({ name, stars:s, text:txt });
      document.getElementById('reviewerName').value='';
      document.getElementById('reviewText').value='';
      document.getElementById('reviewStars').value='3';
      updatePreview();
      renderAddedReviewsList();
    }
    function renderAddedReviewsList() {
      const container = document.getElementById('addedReviewsList');
      container.innerHTML = '';
      reviews.forEach((rev, idx) => {
        const row = document.createElement('div');
        row.classList.add('builder-item-row');
        const nameSpan = document.createElement('span');
        nameSpan.textContent = rev.name || "Unnamed";
        row.appendChild(nameSpan);
        const delBtn = document.createElement('button');
        delBtn.classList.add('delete-btn');
        delBtn.textContent = 'Ã—';
        delBtn.onclick = function () {
          reviews.splice(idx, 1);
          renderAddedReviewsList();
          updatePreview();
        };
        row.appendChild(delBtn);
        container.appendChild(row);
      });
    }
    function updatePreview(){
      heroData.logo     = document.getElementById('logo').value.trim();
      heroData.banner   = document.getElementById('banner').value.trim();
      heroData.heroText = document.getElementById('heroText').value.trim();
      heroData.ctaText  = document.getElementById('ctaText').value.trim();
      aboutData.title     = document.getElementById('aboutTitle').value.trim();
      aboutData.paragraph = document.getElementById('aboutParagraph').value.trim();
      aboutData.image     = document.getElementById('aboutImage').value.trim();
      contactData.intro       = document.getElementById('contactIntro').value.trim();
      contactData.instagram   = document.getElementById('contactInstagram').value.trim();
      contactData.tiktok      = document.getElementById('contactTiktok').value.trim();
      contactData.facebook    = document.getElementById('contactFacebook').value.trim();
      contactData.xLink       = document.getElementById('contactX').value.trim();
      contactData.youtube     = document.getElementById('contactYoutube').value.trim();
      contactData.email       = document.getElementById('contactEmail').value.trim();
      finalHTML = buildFinalHTML();
      var iframe = document.getElementById('previewFrame');
      var doc    = iframe.contentDocument || iframe.contentWindow.document;
      doc.open();
      doc.write(finalHTML);
      doc.close();
      // Update pay button state and styling:
      var payBtn = document.getElementById('payBtn');
      if(checkMandatory()) {
        payBtn.disabled = false;
        payBtn.classList.add('enabled');
      } else {
        payBtn.disabled = true;
        payBtn.classList.remove('enabled');
      }
    }
    function buildFinalHTML(){
      var top = "";
      top += "<!DOCTYPE html><html><head><meta charset='UTF-8'><title>My Product Site (Static Version)</title>";
      top += "<meta name='viewport' content='width=device-width, initial-scale=1.0'>";
      top += "<link href='https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap' rel='stylesheet'>";
      top += buildGlobalCSS();
      // Set favicon directly if a logo URL was provided:
      if(heroData.logo.trim() !== ""){
        top += "<link rel='shortcut icon' href='" + escapeHTML(heroData.logo.trim()) + "'>";
      }
      if(contactData.googleAnalytics){
        top += "\n<!-- Google Analytics -->\n" + contactData.googleAnalytics + "\n";
      }
      top += "</head><body>";
      top += buildTopHeader();
      top += buildHero();
      top += buildProductsSection();
      top += buildReviewsSection();
      top += buildAboutSection();
      top += buildContactSection();
      top += buildProductModalScript();
      top += "</body></html>";
      return top;
    }
    function downloadSite(){
      if(!finalHTML.trim()){
        finalHTML = buildFinalHTML();
      }
      var link = document.createElement('a');
      var dataUri = "data:text/html;charset=utf-8," + encodeURIComponent(finalHTML);
      link.href = dataUri;
      link.download = "index.html";
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    }
    function buildGlobalCSS(){
      var s="<style>html{scroll-behavior:smooth;} *{box-sizing:border-box;transition:all 0.2s ease;} html,body{margin:0;padding:0;font-family:'Roboto',sans-serif;background:#ffffff;color:#333;line-height:1.6;} a{text-decoration:none;color:#2196f3} a:hover{opacity:0.8} img{max-width:100%;height:auto;display:block}";
      s+=".top-header{background:#fff;box-shadow:0 1px 3px rgba(0,0,0,0.1);padding:15px 10px;text-align:center}";
      s+=".logo-wrapper{display:inline-block} .logo-wrapper img{max-height:50px;width:auto;}";
      s+=".nav-links{margin-top:10px} .nav-links a{display:inline-block;margin:0 10px;padding:8px 12px;color:#555;font-weight:500;border-radius:4px;transition:background 0.2s,color 0.2s}";
      s+=".hero-banner{position:relative;min-height:70vh;display:flex;align-items:center;justify-content:center;overflow:hidden;background-size:cover;background-position:center}";
      s+=".hero-overlay{position:relative;z-index:1;text-align:center;color:#fff;padding:15px}";
      s+=".hero-title{font-size:2.5rem;margin:0 0 15px;text-shadow:1px 1px 3px rgba(0,0,0,0.3)}";
      s+=".hero-cta{display:inline-block;padding:12px 25px;background:#fff;color:#333;font-weight:600;border-radius:4px;transition:background 0.3s}";
      s+=".hero-cta:hover{background:#2196f3;color:#fff}";
      s+=".products-grid{display:grid;grid-gap:20px;grid-template-columns:repeat(auto-fill,minmax(250px,1fr));padding:30px 10px;max-width:1300px;margin:0 auto}";
      s+=".product-item{background:#fff;border-radius:8px;overflow:hidden;border:1px solid #eee;cursor:pointer;text-align:left;transition:transform 0.2s,box-shadow 0.2s}";
      s+=".product-item:hover{transform:translateY(-3px);box-shadow:0 3px 6px rgba(0,0,0,0.1)}";
      s+=".product-img{width:100%;padding-bottom:100%;background-size:cover;background-position:center}";
      s+=".product-content{padding:15px}";
      s+=".product-content h3{margin:0 0 8px;font-size:1.2rem;font-weight:600;color:#222}";
      s+=".product-content h2{margin:0 0 10px;font-size:1rem;font-weight:500;color:#28a745}";
      s+=".buy-now{display:block;width:100%;padding:10px 0;background:#007bff;color:#fff;text-align:center;border-radius:4px;font-weight:600;transition:background 0.3s}";
      s+=".buy-now:hover{background:#0056b3}";
      s+=".reviews-section{background:#fff;padding:40px 20px;text-align:center}";
      s+=".reviews-section h2{margin-bottom:30px;font-size:1.8rem;color:#555}";
      s+=".review-container{display:flex;justify-content:center;flex-wrap:wrap;gap:20px}";
      s+=".review-item{background:#f9f9f9;border-radius:8px;padding:20px;box-shadow:0 1px 4px rgba(0,0,0,0.05);max-width:300px;transition:transform 0.3s ease,box-shadow 0.3s ease;text-align:left}";
      s+=".review-item:hover{transform:translateY(-3px);box-shadow:0 4px 8px rgba(0,0,0,0.1)}";
      s+=".review-item h4{margin:0 0 10px;font-weight:600;font-size:1.1rem}";
      s+=".review-stars{color:#ffc107;font-size:1.2rem;margin-bottom:10px}";
      s+=".review-item p{margin:5px 0 0;color:#666}";
      s+=".about-section{background:#fff;display:flex;flex-wrap:wrap;align-items:center;justify-content:center;padding:40px 20px;max-width:100%px;margin:0 auto}";
      s+=".about-left,.about-right{margin-left:20px;flex:1 1 300px;padding:15px}";
      s+=".about-left h2{margin-top:0;color:#444;font-size:2rem}";
      s+=".about-left p{color:#555;line-height:1.8;font-size:1rem}";
      s+=".about-right img{border-radius:8px;max-width:70%;height:auto;box-shadow:0 1px 4px rgba(0,0,0,0.05);transition:transform 0.3s}";
      s+=".about-right img:hover{transform:scale(1.02)}";
      s+=".contact-section{border:0px solid #ddd; background:#ffffff;color:#333;padding:40px 20px;max-width:1200px;margin:40px auto;display:flex;gap:20px;flex-wrap:wrap;align-items:flex-start;justify-content:center}";
      s+=".contact-left{flex:1 1 300px; text-align:left}";
      s+=".contact-logo-left img{max-height:50px;width:auto;margin-bottom:15px}";
      s+=".contact-left p{font-size:0.95rem;color:#555; margin-bottom:15px;}";
      s+=".contact-social-icons{display:flex;flex-wrap:wrap;gap:15px;margin-bottom:15px}";
      s+=".contact-social-icons img{width:35px;height:35px;cursor:pointer;transition:transform 0.3s;border-radius:4px}";
      s+=".contact-social-icons img:hover{transform:scale(1.05)}";
      s+=".contact-email-line{margin-top:10px; color:#333; font-size:0.95rem; margin-bottom:8px}";
      s+=".email-btn{display:inline-block;padding:10px 20px;background:#2196f3;color:#fff;font-weight:600;border-radius:4px;text-transform:uppercase;letter-spacing:0.5px;transition:background 0.3s;text-align:center}";
      s+=".email-btn:hover{background:#1976d2}";
      s+=".contact-right{flex:1 1 300px;}";
      s += ".modal{display:none;position:fixed;z-index:9999;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:rgba(0,0,0,0.6);justify-content:center;align-items:center;padding:20px}";
      s += ".modal-content{background:#fff;margin:auto;width:90%;max-width:1100px;border-radius:8px;position:relative;padding:20px}";
      s += ".modal-close{position:absolute;top:15px;right:20px;font-size:1.5rem;font-weight:bold;cursor:pointer;line-height:1}";
      s += ".modal-body{display:flex;flex-wrap:wrap;gap:20px}";
      s += ".modal-left{flex:1 1 50%;display:flex;flex-direction:column}";
      s += ".modal-main-image{width:85%;aspect-ratio:4/5;position:relative;overflow:hidden;border-radius:8px}";
      s += ".modal-main-image img{width:100%;height:100%;object-fit:cover}";
      s += ".arrow{position:absolute;top:50%;transform:translateY(-50%);background-color:rgba(255,255,255,0.8);color:#333;padding:0.3rem 0.6rem;border-radius:50%;cursor:pointer;user-select:none;font-weight:bold;box-shadow:0 2px 4px rgba(0,0,0,0.2)}";
      s += ".arrow-left{left:5px}";
      s += ".arrow-right{right:5px}";
      s += ".arrow:hover{background-color:rgba(255,255,255,1)}";
      s += ".modal-thumbnails{display:flex;gap:10px;margin-top:10px}";
      s += ".modal-thumbnails img{width:80px;height:80px;object-fit:cover;border-radius:4px;box-shadow:0 2px 4px rgba(0,0,0,0.1);border:2px solid transparent;cursor:pointer}";
      s += ".modal-right{flex:1 1 45%;display:flex;flex-direction:column}";
      s += ".modal-product-price{font-size:1.6rem;color:#109c15;font-weight:700;margin-bottom:15px}";
      s += ".modal-product-sold{text-align: left;font-size:1rem;color:#333;margin-bottom:15px}";
      s += ".modal-product-title{font-size:1.8rem;margin:0 0 10px;font-weight:700;line-height:1.2}";
      s += ".modal-description{margin-bottom:20px;color:#555}";
      s += ".color-options,.size-options{margin-bottom:15px}";
      s += ".color-options label,.size-options label{font-weight:600;margin-right:10px}";
      s += ".color-options span,.size-options span{display:inline-block;margin-right:5px;background:#f0f0f0;padding:5px 10px;border-radius:4px;font-size:0.9rem;border:1px solid transparent;cursor:pointer}";
      s += ".order-details-panel{border:1px solid #eee;padding:15px;border-radius:8px;background:#fafafa}";
      s += ".order-details-panel h3{margin-top:0;font-size:1.2rem;margin-bottom:15px}";
      s += ".order-item{display:flex;justify-content:space-between;margin-bottom:10px;font-size:0.95rem}";
      s += ".order-item label{color:#555;font-weight:500;margin-right:5px}";
      s += ".order-item .value{font-weight:600}";
      s += ".shipping-info{background:#fff7de;border-left:4px solid #ffc107;padding:10px;font-size:0.9rem;margin-top:10px}";
      s += ".subtotal{margin-top:10px;font-size:1rem;text-align:right;font-weight:bold}";
      s += ".modal-actions{display:flex;gap:10px;margin-top:20px}";
      s += ".modal-actions button{flex:1;background:#2196f3;color:#fff;border:none;padding:12px;border-radius:4px;cursor:pointer;font-weight:600;font-size:1rem;height:50px;transition:background 0.3s}";
      s += ".modal-actions button:hover{background:#1976d2}";
      /* Media Query for Small Screens */
      s+=`
@media (max-width: 768px) {
  .top-header {
    padding: 15px 10px;
    text-align: center;
  }
  .logo-wrapper img {
    margin-top: 15px;
    max-width: 150px;
  }
  .nav-links {
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: nowrap;
    gap: 0px;
    margin-top: 10px;
  }
  .nav-links a {
    padding: 8px 10px;
    font-size: 0.85rem;
    font-weight: 500;
    white-space: nowrap;
  }
  
  .products-grid {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 15px;
    padding: 15px;
  }

  .product-item {
    width: 100%;
    max-width: 300px;
    border-radius: 8px;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
    overflow: hidden;
  }

  .product-img {
    width: 100%;
    aspect-ratio: 1 / 1;
    background-size: cover;
    background-position: center;
  }

  .product-content {
    padding: 15px;
  }

  .product-content h3 {
    font-size: 1rem;
    margin-bottom: 10px;
  }

  .product-content h2 {
    font-size: 1rem;
    color: #109c15;
    margin-bottom: 10px;
  }

  .buy-now {
    padding: 10px;
    font-size: 0.9rem;
    border-radius: 5px;
  }
  
  .modal-content {
    width: 100%;
    max-width: 100%;
    padding: 15px;
    position: relative;
  }

  .modal-close {
    position: absolute;
    top: 10px;
    right: 15px;
    font-size: 2rem;
    font-weight: bold;
    z-index: 10;
    line-height: 1;
    cursor: pointer;
    color: #333;
  }

  .modal-body {
    flex-direction: column;
    gap: 15px;
  }

  .modal-left {
    flex: none;
    align-items: center;
    width: 100%;
  }

  .modal-main-image {
    width: 100%;
    aspect-ratio: 4/5;
    object-fit: cover;
  }

  .modal-thumbs {
    justify-content: center;
    gap: 5px;
  }

  .modal-thumbs img {
    width: 60px;
    height: 60px;
  }

  .modal-right {
    flex: none;
    width: 100%;
    text-align: left;
  }

  .modal-product-title {
    font-size: 1.5rem;
  }

  .modal-product-price {
    font-size: 1.4rem;
  }

  .modal-description {
    font-size: 0.9rem;
  }
  
  .color-options, .size-options {
    gap: 5px;
    justify-content: center;
  }

  .color-options span, .size-options span {
    padding: 6px 10px;
    font-size: 0.8rem;
  }

  .qty-controls {
    justify-content: center;
    gap: 5px;
  }

  .order-details-panel {
    padding: 10px;
    font-size: 0.9rem;
  }

  .modal-actions {
    flex-direction: column;
    gap: 10px;
  }

  .modal-actions button {
    width: 100%;
    height: 45px;
  }
  
  .reviews-section {
    padding: 40px 15px;
  }

  .review-container {
    flex-direction: column;
    align-items: center;
    gap: 20px;
  }

  .review-item {
    max-width: 90%;
    padding: 20px;
    text-align: center;
  }

  .review-item h4 {
    font-size: 1rem;
  }

  .review-stars {
    font-size: 1.3rem;
    margin-bottom: 8px;
  }

  .review-item p {
    font-size: 0.9rem;
    line-height: 1.4;
  }
  
  .about-section {
    flex-direction: column;
    padding: 40px 15px;
  }

  .about-left, .about-right {
    flex: none;
    width: 100%;
    text-align: center;
    padding: 20px;
  }

  .about-left h2 {
    font-size: 1.8rem;
  }

  .about-left p {
    font-size: 1rem;
    line-height: 1.6;
  }

  .about-right img {
    max-width: 100%;
    height: auto;
    border-radius: 8px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
  }
  
  .contact-section {
    padding: 40px 15px;
    text-align: center;
  }

  .contact-logo {
    max-width: 150px;
    margin-bottom: 15px;
  }

  .contact-section p {
    font-size: 0.95rem;
    line-height: 1.5;
    margin-bottom: 20px;
  }

  .contact-links {
    flex-wrap: wrap;
    gap: 15px;
    justify-content: center;
  }

  .contact-links img {
    width: 35px;
    height: 35px;
    margin-bottom: 10px;
  }

  .contact-email span {
    font-size: 0.9rem;
    margin-bottom: 10px;
  }

  .email-btn {
    font-size: 0.9rem;
    padding: 10px 20px;
    border-radius: 4px;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
  }
}
      `;
      s+="</style>";
      return s;
    }
    function buildTopHeader(){
      var h="";
      h+="<header class='top-header'><div class='logo-wrapper'>";
      if(heroData.logo){
        h+="<img src='"+escapeHTML(heroData.logo)+"' alt='Logo'>";
      }
      h+="</div><div class='nav-links'>";
      h+="<a href='#products'>Shop</a>";
      h+="<a href='#reviews'>Reviews</a>";
      h+="<a href='#about'>About Us</a>";
      h+="<a href='#contact'>Contact Us</a>";
      h+="</div></header>";
      return h;
    }
    function buildHero(){
      if(!heroData.banner){
        var minimal="";
        minimal+="<section class='hero-banner' style='background:none; min-height:200px;'>";
        minimal+="<div class='hero-overlay'>";
        if(heroData.heroText){
          minimal+="<h1 class='hero-title'>"+escapeHTML(heroData.heroText)+"</h1>";
        }
        if(heroData.ctaText){
          minimal+="<a class='hero-cta' href='#products'>"+escapeHTML(heroData.ctaText)+"</a>";
        }
        minimal+="</div></section>";
        return minimal;
      }
      var bkg=escapeHTML(heroData.banner);
      var s="";
      s+="<section class='hero-banner' style=\"background-image:url('"+bkg+"');\">";
      s+="<div class='hero-overlay'>";
      if(heroData.heroText){
        s+="<h1 class='hero-title'>"+escapeHTML(heroData.heroText)+"</h1>";
      }
      if(heroData.ctaText){
        s+="<a class='hero-cta' href='#products'>"+escapeHTML(heroData.ctaText)+"</a>";
      }
      s+="</div></section>";
      return s;
    }
    function buildProductsSection(){
      if(products.length===0) return "<section id='products'><div class='products-grid'></div></section>";
      var html="";
      for(var i=0;i<products.length;i++){
        var p=products[i];
        var mainImg=(p.images.length>0)?escapeHTML(p.images[0]):"";
        var symbol=getCurrencySymbol(p.currency);
        html+="<div class='product-item'"+
             " data-title='"+escapeHTML(p.title||"")+"'"+
             " data-sold='"+escapeHTML(p.sold||"")+"'"+
             " data-price='"+escapeHTML(p.price||"0")+"'"+
             " data-currency='"+escapeHTML(p.currency||"$")+"'"+
             " data-description='"+escapeHTML(p.description||"")+"'"+
             " data-shipping='"+escapeHTML(p.shipping||"FREE")+"'"+
             " data-returns='"+escapeHTML(p.returns||"Accepted")+"'"+
             " data-coloroptions='"+escapeHTML(p.coloroptions||"")+"'"+
             " data-sizeoptions='"+escapeHTML(p.sizeoptions||"")+"'"+
             " data-images1='"+(p.images[0]||"")+"'"+
             " data-images2='"+(p.images[1]||"")+"'"+
             " data-images3='"+(p.images[2]||"")+"'"+
             " data-paymentmethod='"+escapeHTML(p.paymentMethod||"")+"'"+
             " data-paypallink='"+escapeHTML(p.paypalLink||"")+"'"+
             " data-paypalembed='"+escapeHTML(p.paypalEmbed||"")+"'"+
             " data-otherpaymentlink='"+escapeHTML(p.otherPaymentLink||"")+"'"+
             ">";
        html+="<div class='product-img' style=\"background-image:url('"+mainImg+"');\"></div>";
        html+="<div class='product-content'>";
        html+=(p.title? "<h3>"+escapeHTML(p.title)+"</h3>":"<h3>Untitled Product</h3>");
        html+="<h2>"+symbol+escapeHTML(p.price||"0")+"</h2>";
        html+="<a class='buy-now' href='#'>Buy Now</a>";
        html+="</div></div>";
      }
      return "<section id='products'><div class='products-grid'>"+html+"</div></section>";
    }
    function buildReviewsSection(){
      if(reviews.length===0)return "";
      var r="<section class='reviews-section' id='reviews'><h2>Reviews</h2><div class='review-container'>";
      for(var i=0;i<reviews.length;i++){
        var rv=reviews[i];
        var starCount=parseInt(rv.stars,10)||3;
        var starSymbols="";
        for(var s=0;s<starCount;s++){ starSymbols+="â˜…"; }
        for(var s2=starCount;s2<5;s2++){ starSymbols+="â˜†"; }
        r+="<div class='review-item'><h4>"+escapeHTML(rv.name)+"</h4><div class='review-stars'>"+starSymbols+"</div><p>"+escapeHTML(rv.text)+"</p></div>";
      }
      r+="</div></section>";
      return r;
    }
    function buildAboutSection(){
      if(!aboutData.title && !aboutData.paragraph && !aboutData.image) return "";
      var a="";
      a+="<section class='about-section' id='about'><div class='about-left'>";
      a+="<h2>"+escapeHTML(aboutData.title||"Who We Are")+"</h2>";
      a+="<p>"+escapeHTML(aboutData.paragraph||"We are a small business...")+"</p>";
      a+="</div><div class='about-right'>";
      if(aboutData.image){
        a+="<img src='"+escapeHTML(aboutData.image)+"' alt='About Image'>";
      }
      a+="</div></section>";
      return a;
    }
    function buildContactSection(){
      var anyFilled = contactData.intro || contactData.instagram || contactData.tiktok || contactData.facebook || contactData.xLink || contactData.youtube || contactData.email || contactData.formEmbed;
      if(!anyFilled) return "";
      var c="<section class='contact-section' id='contact'>";
      c+="<div class='contact-left'>";
      c+="<div class='contact-logo-left'>";
      if(heroData.logo){
        c+="<img src='"+escapeHTML(heroData.logo)+"' alt='Logo'>";
      }
      c+="</div>";
      if(contactData.intro){
        c+="<p>"+escapeHTML(contactData.intro)+"</p>";
      }
      let iconsHTML="";
      if(contactData.instagram) iconsHTML+="<a href='"+escapeHTML(contactData.instagram)+"' target='_blank'><img src='https://i.ibb.co/L6zwnKk/Bella-50.png' alt='Instagram'></a>";
      if(contactData.tiktok)    iconsHTML+="<a href='"+escapeHTML(contactData.tiktok)+"' target='_blank'><img src='https://i.ibb.co/2vSmtt0/Bella-49.png' alt='TikTok'></a>";
      if(contactData.facebook)  iconsHTML+="<a href='"+escapeHTML(contactData.facebook)+"' target='_blank'><img src='https://i.ibb.co/gmDjkH3/Bella-48.png' alt='Facebook'></a>";
      if(contactData.xLink)     iconsHTML+="<a href='"+escapeHTML(contactData.xLink)+"' target='_blank'><img src='https://i.ibb.co/fqp0KrB/Bella-63.png' alt='X'></a>";
      if(contactData.youtube)   iconsHTML+="<a href='"+escapeHTML(contactData.youtube)+"' target='_blank'><img src='https://i.ibb.co/hC6CQzs/Bella-62.png' alt='Youtube'></a>";
      if(iconsHTML){
        c+="<div class='contact-social-icons'>"+iconsHTML+"</div>";
      }
      if(contactData.email){
        c+="<div class='contact-email-line'>"+escapeHTML(contactData.email)+"</div>";
        if(!contactData.formEmbed){
          c+="<a class='email-btn' href='mailto:"+escapeHTML(contactData.email)+"'>Send Us an Email</a>";
        }
      }
      c+="</div>";
      c+="<div class='contact-right'>";
      if(contactData.formEmbed){
        c+="<div class='contact-embed'>"+contactData.formEmbed+"</div>";
      }
      c+="</div>";
      c+="</section>";
      return c;
    }
    // ============== PRODUCT MODAL SCRIPT (internal) ==============
    function buildProductModalScript(){
      var m="";
      m+="<script>(function(){";
      m+="function getSymbol(cc){";
      m+="  const known={USD:'$',EUR:'â‚¬',GBP:'Â£',JPY:'Â¥',AUD:'A$',CAD:'C$',CHF:'CHF',CNY:'Â¥',HKD:'HK$',NZD:'NZ$'};";
      m+="  return known[cc.toUpperCase()]||cc+' ';}";
      m+="var modal=document.createElement('div');";
      m+="modal.id='productModal'; modal.className='modal';";
      m+="modal.innerHTML=`";
      m+="<div class='modal-content'>\
         <span class='modal-close'>&times;</span>\
         <div class='modal-body'>\
           <div class='modal-left'>\
             <div class='modal-main-image'>\
               <div class='arrow arrow-left' id='arrowLeft'>â®</div>\
               <img id='modalMainImg' src='' alt='Main Product Image'>\
               <div class='arrow arrow-right' id='arrowRight'>â¯</div>\
             </div>\
             <div class='modal-thumbnails' id='modalThumbnails'></div>\
           </div>\
           <div class='modal-right'>\
             <h1 id='modalTitle' class='modal-product-title'></h1>\
             <div style='display:flex;flex-direction:row;justify-content:flex-start;align-items:center;'>\
               <div id='modalPrice' class='modal-product-price'>$0.00</div>\
               <div id='modalSold' class='modal-product-sold' style='margin-left:10px;'></div>\
             </div>\
             <div id='modalDescription' class='modal-description'></div>\
             <div class='color-options'><label>Color:</label><span id='colorPlaceholders'></span></div>\
             <div class='size-options'><label>Size:</label><span id='sizePlaceholders'></span></div>\
             <div class='order-details-panel'>\
               <h3>Order Details</h3>\
               <div class='order-item'><label>Price:</label><span class='value' id='itemPrice'>--</span></div>\
               <div class='order-item'><label>Shipping:</label><span class='value' id='shippingCost'>$0.00</span></div>\
               <div class='order-item'><label>Returns:</label><span class='value' id='returnPolicy'></span></div>\
               <div class='shipping-info' id='shippingInfo'><strong>Shipping Information:</strong> If your PayPal shipping address or contact details have changed, please update them at checkout so we send your goodies to the right place!</div>\
               <div class='subtotal'>Total: <span id='subtotalValue'>$0.00</span></div>\
             </div>\
             <div class='modal-actions'>\
               <button class='buy-now-btn'>Buy Now</button>\
             </div>\
           </div>\
         </div>\
       </div>`;";
      m+="document.body.appendChild(modal);";
      m+="var productModal=document.getElementById('productModal');";
      m+="var closeBtn=productModal.querySelector('.modal-close');";
      m+="var mainImg=productModal.querySelector('#modalMainImg');";
      m+="var modalTitle=productModal.querySelector('#modalTitle');";
      m+="var modalPrice=productModal.querySelector('#modalPrice');";
      m+="var modalSold=productModal.querySelector('#modalSold');";
      m+="var modalDescription=productModal.querySelector('#modalDescription');";
      m+="var colorPH=productModal.querySelector('#colorPlaceholders');";
      m+="var sizePH=productModal.querySelector('#sizePlaceholders');";
      m+="var itemPrice=productModal.querySelector('#itemPrice');";
      m+="var shippingCost=productModal.querySelector('#shippingCost');";
      m+="var returnPolicy=productModal.querySelector('#returnPolicy');";
      m+="var subtotalValue=productModal.querySelector('#subtotalValue');";
      m+="var arrowLeft=productModal.querySelector('#arrowLeft');";
      m+="var arrowRight=productModal.querySelector('#arrowRight');";
      m+="var thumbsContainer=productModal.querySelector('#modalThumbnails');";
      m+="var buyNowBtn=productModal.querySelector('.buy-now-btn');";
      m+="var currentProduct=null;";
      m+="var allImages=[];";
      m+="var currentIndex=0;";
      m+="var basePrice=0; var shippingFee=0; var returnsText='Accepted';";
      m+="function updateOrderDetails(){";
      m+="  var total=basePrice + shippingFee;";
      m+="  itemPrice.textContent=getSymbol(currentProduct.currency||'$')+basePrice.toFixed(2);";
      m+="  if(shippingFee===0){ shippingCost.textContent='FREE'; } else { shippingCost.textContent=getSymbol(currentProduct.currency||'$')+shippingFee.toFixed(2);}";
      m+="  returnPolicy.textContent=returnsText;";
      m+="  subtotalValue.textContent=getSymbol(currentProduct.currency||'$')+total.toFixed(2);";
      m+="}";
      m+="function showImageAt(idx){ if(idx<0||idx>=allImages.length)return; currentIndex=idx; mainImg.src=allImages[idx];";
      m+="  Array.from(thumbsContainer.children).forEach((imgEl,i)=>{ imgEl.style.borderColor=(i===idx)?'#2196f3':'transparent';});";
      m+="}";
      m+="function openModal(prod){ currentProduct=prod; productModal.style.display='flex'; allImages=[];";
      m+="  if(prod.images1)allImages.push(prod.images1); if(prod.images2)allImages.push(prod.images2); if(prod.images3)allImages.push(prod.images3);";
      m+="  modalTitle.textContent=prod.title||'';";
      m+="  if(prod.sold) modalSold.textContent=prod.sold+' Sold'; else modalSold.textContent='';";
      m+="  modalPrice.textContent=getSymbol(prod.currency||'$')+(prod.price||'0');";
      m+="  modalDescription.textContent=prod.description||'';";
      m+="  basePrice=parseFloat(prod.price)||0;";
      m+="  if(prod.shipping==='FREE') shippingFee=0; else shippingFee=parseFloat(prod.shipping)||0;";
      m+="  returnsText=prod.returns||'Accepted';";
      m+="  thumbsContainer.innerHTML='';";
      m+="  if(allImages.length>0){ showImageAt(0);} else { mainImg.src='https://via.placeholder.com/400?text=No+Image';}";
      m+="  for(var i=0;i<allImages.length;i++){";
      m+="    var t=document.createElement('img'); t.src=allImages[i]; t.dataset.index=i; t.onclick=function(){ showImageAt(parseInt(this.dataset.index));};";
      m+="    if(i===0){t.style.borderColor='#2196f3';}";
      m+="    thumbsContainer.appendChild(t);";
      m+="  }";
      m+="  colorPH.innerHTML='';";
      m+="  if(prod.coloroptions){ var cArr=prod.coloroptions.split(','); cArr.forEach(function(c){ c=c.trim(); if(c){ var sp=document.createElement('span'); sp.textContent=c; colorPH.appendChild(sp);}});}";
      m+="  sizePH.innerHTML='';";
      m+="  if(prod.sizeoptions){ var sArr=prod.sizeoptions.split(','); sArr.forEach(function(sz){ sz=sz.trim(); if(sz){ var sp=document.createElement('span'); sp.textContent=sz; sizePH.appendChild(sp);}});}";
      m+="  updateOrderDetails();";
      m+="}";
      m+="document.querySelectorAll('.product-item').forEach(function(pi){";
      m+="  var pd={};";
      m+="  pd.title=pi.getAttribute('data-title')||'';";
      m+="  pd.sold=pi.getAttribute('data-sold')||'';";
      m+="  pd.price=pi.getAttribute('data-price')||'0';";
      m+="  pd.currency=pi.getAttribute('data-currency')||'$';";
      m+="  pd.description=pi.getAttribute('data-description')||'';";
      m+="  pd.shipping=pi.getAttribute('data-shipping')||'FREE';";
      m+="  pd.returns=pi.getAttribute('data-returns')||'Accepted';";
      m+="  pd.coloroptions=pi.getAttribute('data-coloroptions')||'';";
      m+="  pd.sizeoptions=pi.getAttribute('data-sizeoptions')||'';";
      m+="  pd.images1=pi.getAttribute('data-images1')||'';";
      m+="  pd.images2=pi.getAttribute('data-images2')||'';";
      m+="  pd.images3=pi.getAttribute('data-images3')||'';";
      m+="  pd.paymentMethod=pi.getAttribute('data-paymentmethod')||'';";
      m+="  pd.paypalLink=pi.getAttribute('data-paypallink')||'';";
      m+="  pd.paypalEmbed=pi.getAttribute('data-paypalembed')||'';";
      m+="  pd.otherPaymentLink=pi.getAttribute('data-otherpaymentlink')||'';";
      m+="  pi.addEventListener('click',function(){ openModal(pd);});";
      m+="  var buy=pi.querySelector('.buy-now');";
      m+="  if(buy){";
      m+="    buy.addEventListener('click',function(e){ e.preventDefault(); e.stopPropagation(); openModal(pd);});";
      m+="  }";
      m+="});";
      m+="closeBtn.onclick=function(){ productModal.style.display='none';};";
      m+="modal.addEventListener('click', function(e){ if(e.target==modal){ modal.style.display='none'; } });";
      m+="arrowLeft.onclick=function(){ if(currentIndex>0){showImageAt(currentIndex-1);} };";
      m+="arrowRight.onclick=function(){ if(currentIndex<allImages.length-1){showImageAt(currentIndex+1);} };";
      m+="buyNowBtn.onclick=function(){";
      m+="  if(!currentProduct)return;";
      m+="  if(currentProduct.paymentMethod==='paypalLink'){ window.open(currentProduct.paypalLink,'_blank');}";
      m+="  else if(currentProduct.paymentMethod==='paypalEmbed'){ var newWin=window.open('','_blank'); newWin.document.write(currentProduct.paypalEmbed);}";
      m+="  else if(currentProduct.paymentMethod==='other'){ if(currentProduct.otherPaymentLink){window.open(currentProduct.otherPaymentLink,'_blank');} else{alert('No other payment link provided.');}}";
      m+="  else{ alert('Payment method not configured.'); }";
      m+="};";
      m+="})();<\/script>";
      return m;
    }
    function getCurrencySymbol(code){
      const sym={
        AED:"Ø¯.Ø¥",AFN:"Ø‹",ALL:"L",AMD:"Ö",ANG:"Æ’",AOA:"Kz",ARS:"$",AUD:"A$",AWG:"Æ’",
        AZN:"â‚¼",BAM:"KM",BBD:"Bds$",BDT:"à§³",BGN:"Ğ»Ğ²",BHD:"Ø¯.Ø¨",BIF:"FBu",BMD:"$",
        BND:"B$",BOB:"$b",BRL:"R$",BSD:"$",BTN:"Nu.",BWP:"P",BYN:"Br",BZD:"BZ$",
        CAD:"C$",CDF:"FC",CHF:"CHF",CLP:"$",CNY:"Â¥",COP:"$",CRC:"â‚¡",CUC:"$",CUP:"$",
        CVE:"$",CZK:"KÄ",DJF:"Fdj",DKK:"kr",DOP:"RD$",DZD:"Ø¯.Ø¬",EGP:"Â£",ERN:"Nfk",
        ETB:"Br",EUR:"â‚¬",FJD:"FJ$",FKP:"Â£",FOK:"kr",GBP:"Â£",GEL:"â‚¾",GGP:"Â£",GHS:"â‚µ",
        GIP:"Â£",GMD:"D",GNF:"FG",GTQ:"Q",GYD:"G$",HKD:"HK$",HNL:"L",HRK:"kn",
        HTG:"G",HUF:"Ft",IDR:"Rp",ILS:"â‚ª",IMP:"Â£",INR:"â‚¹",IQD:"Ø¹.Ø¯",IRR:"ï·¼",
        ISK:"kr",JEP:"Â£",JMD:"J$",JOD:"Ø¯.Ø§",JPY:"Â¥",KES:"KSh",KGS:"ÑĞ¾Ğ¼",KHR:"áŸ›",
        KMF:"CF",KPW:"â‚©",KRW:"â‚©",KWD:"Ø¯.Ùƒ",KYD:"KYD",KZT:"â‚¸",LAK:"â‚­",LBP:"Â£",
        LKR:"Rs",LRD:"L$",LSL:"L",LYD:"Ù„.Ø¯",MAD:"Ø¯.Ù….",MDL:"L",MGA:"Ar",MKD:"Ğ´ĞµĞ½",
        MMK:"K",MNT:"â‚®",MOP:"MOP$",MRU:"UM",MUR:"â‚¨",MVR:"Rf",MWK:"MK",MXN:"$",
        MYR:"RM",MZN:"MT",NAD:"N$",NGN:"â‚¦",NIO:"C$",NOK:"kr",NPR:"â‚¨",NZD:"NZ$",
        OMR:"Ø±.Ø¹.",PAB:"B/.",PEN:"S/.",PGK:"K",PHP:"â‚±",PKR:"â‚¨",PLN:"zÅ‚",PYG:"â‚²",
        QAR:"Ø±.Ù‚",RON:"lei",RSD:"din",RUB:"â‚½",RWF:"FRw",SAR:"Ø±.Ø³",SBD:"SI$",SCR:"â‚¨",
        SDG:"Â£",SEK:"kr",SGD:"S$",SHP:"Â£",SLL:"Le",SOS:"S",SRD:"$",SSP:"Â£",
        STD:"Db",STN:"Db",SVC:"$",SYP:"Â£",SZL:"E",THB:"à¸¿",TJS:"Ğ…Ğœ",TMT:"m",
        TND:"Ø¯.Øª",TOP:"T$",TRY:"â‚º",TTD:"TT$",TWD:"NT$",TZS:"TSh",UAH:"â‚´",UGX:"USh",
        USD:"$",UYU:"$U",UZS:"UZS",VES:"Bs.S",VND:"â‚«",VUV:"VT",WST:"WS$",XAF:"FCFA",
        XCD:"EC$",XDR:"XDR",XOF:"CFA",XPF:"CFPF",YER:"ï·¼",ZAR:"R",ZMW:"ZK",ZWL:"Z$"
      };
      return sym[code.toUpperCase()]||code+" ";
    }
    function escapeHTML(str){
      if(!str)return "";
      return str.replace(/[<>"'&]/g,function(c){
        switch(c){
          case '<':return '&lt;';
          case '>':return '&gt;';
          case '"':return '&quot;';
          case "'":return '&#39;';
          case '&':return '&amp;';
        }
      });
    }
    function redirectToUpload(){
      window.open("https://imgbb.com","_blank");
    }
    function updateManagementLists(){
      const cont = document.getElementById('managementContainer');
      cont.innerHTML = "";
      if(products.length>0){
        const pDiv = document.createElement('div');
        pDiv.innerHTML = "<h3>Products in Website</h3>";
        products.forEach((prod, idx)=>{
          const row = document.createElement('div');
          row.classList.add('builder-item-row');
          row.innerHTML = `<span>${escapeHTML(prod.title||"Untitled")}</span>`;
          const delBtn = document.createElement('button');
          delBtn.classList.add('delete-btn');
          delBtn.textContent="Ã—";
          delBtn.onclick=function(){
            products.splice(idx,1);
            updatePreview();
            updateManagementLists();
          };
          row.appendChild(delBtn);
          pDiv.appendChild(row);
        });
        cont.appendChild(pDiv);
      }
      if(reviews.length>0){
        const rDiv = document.createElement('div');
        rDiv.innerHTML="<h3>Reviews in Website</h3>";
        reviews.forEach((rev, idx)=>{
          const row=document.createElement('div');
          row.classList.add('builder-item-row');
          row.innerHTML=`<span>${escapeHTML(rev.name||"Unnamed")}</span>`;
          const delBtn=document.createElement('button');
          delBtn.classList.add('delete-btn');
          delBtn.textContent="Ã—";
          delBtn.onclick=function(){
            reviews.splice(idx,1);
            updatePreview();
            updateManagementLists();
          };
          row.appendChild(delBtn);
          rDiv.appendChild(row);
        });
        cont.appendChild(rDiv);
      }
      if(contactData.formEmbed){
        const cfDiv=document.createElement('div');
        cfDiv.innerHTML="<h3>Contact Form</h3><span>Contact Form</span>";
        const delBtn=document.createElement('button');
        delBtn.classList.add('delete-btn');
        delBtn.textContent="Ã—";
        delBtn.onclick=function(){
          contactData.formEmbed="";
          const addBtn = document.getElementById('addContactFormButton');
          addBtn.classList.remove('success');
          addBtn.textContent="Add Form";
          updatePreview();
          updateManagementLists();
        };
        cfDiv.appendChild(delBtn);
        cont.appendChild(cfDiv);
      }
    }
    // ---- Payment Button Logic ----
    document.getElementById('payBtn').onclick = function () {
      if (!checkMandatory()) {
        alert("Please fill in all mandatory fields before proceeding with payment.");
        return;
      }
      var paypalPopup = window.open(
        "https://www.paypal.com/cgi-bin/webscr?cmd=_xclick&business=workpoost%40gmail.com&item_name=Website+Builder+Download&amount=12&currency_code=EUR",
        "_blank",
        "width=500,height=700"
      );
      var startTime = Date.now();
      var thresholdTime = 10 * 1000; // 10 seconds
      var popupTimer = setInterval(function () {
        if (paypalPopup && paypalPopup.closed) {
          clearInterval(popupTimer);
          var elapsedTime = Date.now() - startTime;
          if (elapsedTime >= thresholdTime) {
            document.getElementById('emailVerificationRow').style.display = 'flex';
          } else {
            alert("Payment was not completed. Please try again.");
          }
        }
      }, 500);
    };
    document.getElementById('verifyEmailBtn').onclick = function() {
      var email = document.getElementById('verificationEmail').value.trim();
      if(email === "") {
        alert("Please enter your email for verification.");
        return;
      }
      var payBtn = document.getElementById('payBtn');
      payBtn.innerHTML = "Payment Successful";
      payBtn.style.background = "green";
      payBtn.disabled = true;
      document.getElementById('downloadRow').style.display = 'flex';
      document.getElementById('emailVerificationRow').style.display = 'none';
    };
    // Code Modal Functions
    function openCodeModal(){
      if(!finalHTML.trim()){
        finalHTML = buildFinalHTML();
      }
      var codeOutput = document.getElementById('codeOutput');
      codeOutput.value = finalHTML;
      document.getElementById('codeModal').style.display = 'flex';
    }
    document.getElementById('copyCodeButton').onclick = function(){
      var codeOutput = document.getElementById('codeOutput');
      codeOutput.select();
      document.execCommand('copy');
      this.textContent = "Copied!";
      setTimeout(() => {
        this.textContent = "Copy Code";
      }, 2000);
    };
    document.getElementById('closeCodeModal').onclick = function(){
      document.getElementById('codeModal').style.display = 'none';
    };
    // ---- Exit Confirmation Modal Logic ----
    document.addEventListener('DOMContentLoaded', function () {
      const exitModalOverlay = document.getElementById('exitConfirm-modalOverlay');
      const exitModal = document.getElementById('exitConfirm-modal');
      const stayButton = document.getElementById('exitConfirm-stayButton');
      const leaveButton = document.getElementById('exitConfirm-leaveButton');
      let intendedAction = null;
      function showExitModal(action) {
        intendedAction = action;
        exitModalOverlay.style.display = 'flex';
      }
      function hideExitModal() {
        exitModalOverlay.style.display = 'none';
        intendedAction = null;
      }
      stayButton.addEventListener('click', function () {
        hideExitModal();
      });
      leaveButton.addEventListener('click', function () {
        hideExitModal();
        if (typeof intendedAction === 'function') {
          intendedAction();
        } else if (typeof intendedAction === 'string') {
          window.location.href = intendedAction;
        }
      });
      const links = document.querySelectorAll('a');
      links.forEach(function (link) {
        link.addEventListener('click', function (e) {
          if (this.hasAttribute('data-ignore-exit-confirm')) return;
          e.preventDefault();
          const href = this.getAttribute('href');
          showExitModal(function () {
            window.location.href = href;
          });
        });
      });
      const forms = document.querySelectorAll('form');
      forms.forEach(function (form) {
        form.addEventListener('submit', function (e) {
          if (this.hasAttribute('data-ignore-exit-confirm')) return;
          e.preventDefault();
          showExitModal(function () {
            form.submit();
          });
        });
      });
      window.addEventListener('beforeunload', function (e) {
        if (exitModalOverlay.style.display === 'flex') {
          return;
        }
        e.preventDefault();
        e.returnValue = '';
      });
    });
    function setupContactFormModal(){
      var modal = document.getElementById('contactFormModal');
      var openBtn = document.getElementById('addContactFormButton');
      var closeBtn = document.getElementById('closeContactFormModal');
      var confirmBtn = document.getElementById('confirmAddContactFormButton');
      var textarea = document.getElementById('contactFormIframe');
      openBtn.onclick = function(){
        if(contactData.formEmbed){
          alert("A contact form is already added. You can delete it before adding a new one.");
          return;
        }
        modal.style.display = 'flex';
      };
      closeBtn.onclick = function(){
        modal.style.display = 'none';
      };
      confirmBtn.onclick = function() {
        const embedCode = textarea.value.trim();
        if (embedCode) {
          contactData.formEmbed = embedCode;
          modal.style.display = 'none';
          textarea.value = '';
          const addBtn = document.getElementById('addContactFormButton');
          addBtn.classList.add('success');
          addBtn.textContent = 'Form Added';
          const statusDiv = document.getElementById('contactFormStatus');
          statusDiv.innerHTML = '';
          const delFormBtn = document.createElement('button');
          delFormBtn.textContent = 'Delete Form';
          delFormBtn.style.background = 'red';
          delFormBtn.style.color = '#fff';
          delFormBtn.style.border = 'none';
          delFormBtn.style.cursor = 'pointer';
          delFormBtn.style.borderRadius = '4px';
          delFormBtn.style.padding = '5px 10px';
          delFormBtn.onclick = function() {
            contactData.formEmbed = '';
            addBtn.classList.remove('success');
            addBtn.textContent = 'Add Form';
            statusDiv.innerHTML = '';
            updatePreview();
          };
          statusDiv.appendChild(delFormBtn);
          updatePreview();
          updateManagementLists();
        } else {
          alert("Please paste your contact form embed code.");
        }
      };
      window.onclick = function(event){
        if(event.target == modal){
          modal.style.display = 'none';
        }
      };
    }
  </script>
  <script>
    // Function to close the popup
    function closePopup() {
      var popup = document.getElementById('popupMessage');
      if (popup) {
        popup.style.display = 'none';
      }
    }
    
    // Show the popup on page load
    window.addEventListener('load', function() {
      var popup = document.getElementById('popupMessage');
      // Display the popup
      popup.style.display = 'block';
    
      // Auto-close after 15 seconds (15000 milliseconds)
      setTimeout(closePopup, 15000);
    });
    
    // Add click event to the close button
    document.querySelector('#popupMessage .close').addEventListener('click', closePopup);
  </script>
  
</body>
</html>
